{"version":3,"sources":["webpack:///webpack/universalModuleDefinition?5ca6","webpack:///sf.crop.min.js","webpack:///webpack/bootstrap e0c597d8fa25c1088802?ce93","webpack:///d:/OpenServer/domains/spiral-modules/cropper/src/index.js?ee14","webpack:///external \"sf\"?eecf","webpack:///d:/OpenServer/domains/spiral-modules/cropper/src/crop.js?4986","webpack:///d:/OpenServer/domains/spiral-modules/cropper/~/babel-runtime/core-js/object/create.js?ccf8","webpack:///d:/OpenServer/domains/spiral-modules/cropper/~/core-js/library/fn/object/create.js?dd52","webpack:///d:/OpenServer/domains/spiral-modules/cropper/~/core-js/library/modules/$.js?d9fe","webpack:///./src/template.html?60fe","webpack:///./src/crop.less?7543*","webpack:///./src/crop.less?69b2","webpack:///d:/OpenServer/domains/spiral-modules/cropper/~/css-loader/lib/css-base.js?e551","webpack:///./~/style-loader/addStyles.js?b980"],"names":["root","factory","exports","module","require","define","amd","a","i","this","__WEBPACK_EXTERNAL_MODULE_1__","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","_interopRequireDefault","obj","__esModule","default","_sf","_sf2","_crop","_crop2","instancesController","registerInstanceType","_create","_create2","Object","defineProperty","value","undefined","externals","template","Crop","sf","node","options","_construct","prototype","core","BaseDOMConstructor","name","init","that","noop","parser","DOMParser","tools","extend","info","split","ratio","parseFloat","onFileProcessed","els","input","tagName","getElementsByClassName","modal","parseFromString","firstChild","lastChild","preview","document","querySelector","console","warn","ajaximage","cropWrapper","imageOriginal","cropElements","cropSave","closePopup","cropInfo","croppedSize","origSize","handlers","n","ne","e","se","s","sw","w","nw","current","dimmers","el","form","getInstance","reset","addEventListeners","attachData","parentNode","removeChild","xhr","XMLHttpRequest","onreadystatechange","readyState","status","img","Image","url","window","URL","webkitURL","response","Blob","src","createObjectURL","handleFileSelect","adjust","open","responseType","send","navigator","appVersion","indexOf","style","backgroundColor","optionsToGrab","format","domAttr","ajaxAddress","cnv","cursor","x","y","crop","x2","y2","h","toSave","image","old","start","canvas","orig","scale","setTop","setLeft","setWidth","setHeight","changeInfo","type","innerHTML","updateInfo","length","forEach","Math","round","showPopup","body","appendChild","addModalEventListeners","removeEventListeners","hidePopup","removeModalEventListeners","_inputChange","file","target","files","match","display","alert","_openCropper","readyToPrepare","prepare","addEventListener","removeEventListener","_cropSave","save","_hidePopup","_cropWrapperMouseDown","onCropStart","inCropping","_documentMouseMove","preventDefault","onCrop","_cropWrapperMouseUp","onCropEnd","_documentMouseUp","setPreviewImage","newimg","cloneNode","maxWidth","reader","FileReader","onload","theFile","blob","encodeURIComponent","replace","base64","result","clientHeight","clientWidth","naturalHeight","naturalWidth","readAsDataURL","drawImageOnCanvas","ctx","drawImage","setTimeout","createElement","width","height","getContext","offset","getBoundingClientRect","clientX","left","clientY","top","offsetX","layerX","offsetY","layerY","setN","setNE","setE","setSE","setS","setSW","setW","setNW","move","adjustN","notDefaultSide","adjustS","adjustW","adjustE","abs","dataURItoBlob","dataURI","byteString","mimeString","content","atob","decodeURI","charCodeAt","Uint8Array","strDataURI","toDataURL","events","on","data","append","die","$","P","D","create","$Object","getProto","getPrototypeOf","isEnum","propertyIsEnumerable","getDesc","getOwnPropertyDescriptor","setDesc","setDescs","defineProperties","getKeys","keys","getNames","getOwnPropertyNames","getSymbols","getOwnPropertySymbols","each","locals","push","list","toString","item","join","mediaQuery","alreadyImportedModules","addStylesToDom","styles","domStyle","stylesInDom","refs","j","parts","addStyle","listToStyles","newStyles","css","media","sourceMap","part","insertStyleElement","styleElement","head","getHeadElement","lastStyleElementInsertedAtTop","styleElementsInsertedAtTop","insertAt","nextSibling","insertBefore","Error","removeStyleElement","idx","splice","createStyleElement","createLinkElement","linkElement","rel","update","remove","singleton","styleIndex","singletonCounter","singletonElement","applyToSingletonTag","bind","revokeObjectURL","btoa","updateLink","href","applyToTag","newObj","index","styleSheet","cssText","replaceText","cssNode","createTextNode","childNodes","setAttribute","unescape","JSON","stringify","oldSrc","memoize","fn","memo","apply","arguments","isOldIE","test","userAgent","toLowerCase","getElementsByTagName","newList","mayRemove","textStore","replacement","filter","Boolean"],"mappings":"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","file":"sf.crop.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"sf\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"sf\"], factory);\n\telse {\n\t\tvar a = typeof exports === 'object' ? factory(require(\"sf\")) : factory(root[\"sf\"]);\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(this, function(__WEBPACK_EXTERNAL_MODULE_1__) {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/","/*!\n * Spiral Image Cropper Widget v0.4.0\n * https://github.com/spiral-modules/image-cropper/\n * Copyright (c) 2016, Alex Chepura, Yauheni Yasinau, spiralscout.com\n */\n(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"sf\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"sf\"], factory);\n\telse {\n\t\tvar a = typeof exports === 'object' ? factory(require(\"sf\")) : factory(root[\"sf\"]);\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(this, function(__WEBPACK_EXTERNAL_MODULE_1__) {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar _sf = __webpack_require__(1);\n\t\n\tvar _sf2 = _interopRequireDefault(_sf);\n\t\n\tvar _crop = __webpack_require__(2);\n\t\n\tvar _crop2 = _interopRequireDefault(_crop);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t__webpack_require__(7); //resolved in webpack's \"externals\"\n\t\n\t_sf2.default.instancesController.registerInstanceType(_crop2.default, \"js-sf-cropper\");\n\tmodule.exports = _crop2.default; // ES6 default export will not expose us as global\n\n/***/ },\n/* 1 */\n/***/ function(module, exports) {\n\n\tmodule.exports = __WEBPACK_EXTERNAL_MODULE_1__;\n\n/***/ },\n/* 2 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar _create = __webpack_require__(3);\n\t\n\tvar _create2 = _interopRequireDefault(_create);\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.default = undefined;\n\t\n\tvar _sf = __webpack_require__(1);\n\t\n\tvar _sf2 = _interopRequireDefault(_sf);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t//resolved in webpack's \"externals\"\n\t\n\tvar externals = {\n\t    template: __webpack_require__(6)\n\t};\n\tvar Crop = function Crop(sf, node, options) {\n\t    this._construct(sf, node, options);\n\t};\n\t\n\t/**\r\n\t * @lends sf.Form.prototype\r\n\t */\n\tCrop.prototype = (0, _create2.default)(_sf2.default.modules.core.BaseDOMConstructor.prototype);\n\t\n\t/**\r\n\t * Name to register\r\n\t * @type {string}\r\n\t */\n\tCrop.prototype.name = \"crop\";\n\t\n\tCrop.prototype._construct = function (sf, node, options) {\n\t\n\t    this.init(sf, node, options); //call parent\n\t\n\t    this.options.template = this.options.template || externals.template;\n\t\n\t    var that = this,\n\t        noop = function noop() {},\n\t        parser = new DOMParser();\n\t\n\t    if (options) {\n\t        //if we pass options extend all options by passed options\n\t        this.options = sf.tools.extend(this.options, options);\n\t    }\n\t\n\t    if (typeof this.options.info == \"string\") this.options.info = this.options.info.split(\",\");\n\t\n\t    if (this.options.ratio) this.options.ratio = parseFloat(this.options.ratio); //just to be sure about number format, not string\n\t    if (typeof this.options.onFileProcessed != \"function\") this.options.onFileProcessed = noop;\n\t\n\t    //elements\n\t    this.els = {\n\t        node: node,\n\t        input: node.tagName === \"INPUT\" ? node : node.getElementsByClassName(\"sf-crop-input\")[0],\n\t        modal: parser.parseFromString(this.options.template, \"text/html\").firstChild.lastChild.firstChild\n\t    };\n\t\n\t    if (this.options.preview) {\n\t        this.els.preview = document.querySelector(this.options.preview);\n\t    } else {\n\t        console.warn('Cropper: no preview provided');\n\t    }\n\t\n\t    if (!this.options.ajaximage && !this.els.input) {\n\t        console.warn('Provide file-input to use cropper or load image with ajax (with data-ajaximage attr)');\n\t    }\n\t    this.els.cropWrapper = this.els.modal.getElementsByClassName(\"sf-crop-wrapper\")[0];\n\t    this.els.imageOriginal = this.els.modal.getElementsByClassName(\"sf-crop-image-original\")[0];\n\t    this.els.cropElements = this.els.modal.getElementsByClassName(\"sf-crop-elements\")[0];\n\t    this.els.cropSave = this.els.modal.getElementsByClassName(\"sf-crop-save\")[0];\n\t    this.els.closePopup = this.els.modal.getElementsByClassName(\"sf-crop-close\")[0];\n\t\n\t    this.els.cropInfo = {\n\t        ratio: this.els.modal.getElementsByClassName(\"sf-crop-ratio\")[0],\n\t        croppedSize: this.els.modal.getElementsByClassName(\"sf-crop-cropped-size\")[0],\n\t        origSize: this.els.modal.getElementsByClassName(\"sf-crop-orig-size\")[0]\n\t    };\n\t\n\t    this.els.handlers = {\n\t        n: this.els.modal.getElementsByClassName(\"handler-N\")[0],\n\t        ne: this.els.modal.getElementsByClassName(\"handler-NE\")[0],\n\t        e: this.els.modal.getElementsByClassName(\"handler-E\")[0],\n\t        se: this.els.modal.getElementsByClassName(\"handler-SE\")[0],\n\t        s: this.els.modal.getElementsByClassName(\"handler-S\")[0],\n\t        sw: this.els.modal.getElementsByClassName(\"handler-SW\")[0],\n\t        w: this.els.modal.getElementsByClassName(\"handler-W\")[0],\n\t        nw: this.els.modal.getElementsByClassName(\"handler-NW\")[0],\n\t        current: null\n\t    };\n\t\n\t    this.els.dimmers = {\n\t        el: this.els.modal.getElementsByClassName(\"dimmers\")[0],\n\t        n: this.els.modal.getElementsByClassName(\"dimmer-N\")[0],\n\t        e: this.els.modal.getElementsByClassName(\"dimmer-E\")[0],\n\t        s: this.els.modal.getElementsByClassName(\"dimmer-S\")[0],\n\t        w: this.els.modal.getElementsByClassName(\"dimmer-W\")[0]\n\t    };\n\t\n\t    this.els.form = this.els.input ? this.els.input.form : '';\n\t    this.form = sf.instancesController.getInstance(\"form\", this.els.form);\n\t\n\t    this.reset();\n\t    this.addEventListeners();\n\t    this.attachData();\n\t\n\t    if (this.options.ajaximage) {\n\t        if (this.els.input && this.els.input !== this.els.node) this.els.input.parentNode.removeChild(this.els.input); //this check is for not to remove cropper's node and not to trigger die method\n\t        var xhr = new XMLHttpRequest();\n\t        xhr.onreadystatechange = function () {\n\t            if (this.readyState == 4 && this.status == 200) {\n\t                var img = new Image();\n\t                var url = window.URL || window.webkitURL;\n\t                if (this.response instanceof Blob) {\n\t                    img.src = url.createObjectURL(this.response);\n\t                    that.handleFileSelect(this.response);\n\t                    //that.els.adjust.style.display = 'inline-block';\n\t                } else {\n\t                        that.els.adjust.parentNode.removeChild(that.els.adjust);\n\t                    }\n\t            }\n\t        };\n\t        xhr.open('GET', that.options.ajaximage);\n\t        xhr.responseType = 'blob';\n\t        xhr.send();\n\t    }\n\t    //IE10 click to move doesn't work. looks like click goes through cropper to background picture =(\n\t    if (navigator.appVersion.indexOf(\"MSIE 10\") != -1) this.els.cropElements.style.backgroundColor = \"rgba(255,255,255,0.01\";\n\t};\n\t\n\t/**\r\n\t * @override\r\n\t * @inheritDoc\r\n\t * @enum {string}\r\n\t */\n\tCrop.prototype.optionsToGrab = {\n\t    /**\r\n\t     *  How to send: cropped or full size with coordinates to crop on server <b>Default: \"cropped\"</b> <i>Optional: \"full\"</i>\r\n\t     */\n\t    \"format\": {\n\t        \"value\": \"cropped\",\n\t        \"domAttr\": \"data-format\"\n\t    },\n\t    /**\r\n\t     *  Preloading of image  <b>Default: \"false\"</b> <i>Optional: url of image to preload</i>\r\n\t     */\n\t    \"ajaximage\": {\n\t        \"value\": false,\n\t        \"domAttr\": \"data-ajaximage\"\n\t    },\n\t    \"template\": {\n\t        \"domAttr\": \"data-template\"\n\t    },\n\t    /**\r\n\t     *  Request address for submitting (if there is no form) <b>Default: \"false\"</b> <i>Optional: request URL</i>\r\n\t     */\n\t    \"ajaxAddress\": {\n\t        \"value\": false,\n\t        \"domAttr\": \"data-ajaxAddress\"\n\t    },\n\t    /**\r\n\t     *  Locked aspect ratio <b>Default: false</b>\r\n\t     */\n\t    \"ratio\": {\n\t        \"value\": false,\n\t        \"domAttr\": \"data-ratio\"\n\t    },\n\t    /**\r\n\t     *  What info to show <b>Default: []</b></br>\r\n\t     *  <b>Example: </b>data-info=\"ratio,origSize,croppedSize\"</br>\r\n\t     *  <b>Note: </b>done only ratio\r\n\t     */\n\t    \"info\": {\n\t        \"value\": [],\n\t        \"domAttr\": \"data-info\"\n\t    },\n\t    /**\r\n\t     *  ID of preview element <b>Default: \"\"</b>\r\n\t     */\n\t    \"preview\": {\n\t        \"value\": \"\",\n\t        \"domAttr\": \"data-preview\"\n\t    },\n\t    /**\r\n\t     *  Selector of element which twiggers crop-modal <b>Default: \"\"</b>\r\n\t     */\n\t    \"adjust\": {\n\t        \"value\": \"\",\n\t        \"domAttr\": \"data-adjust\"\n\t    },\n\t    /**\r\n\t     *  Name for formData <b>Default: \"cropped\"</b>\r\n\t     */\n\t    \"name\": {\n\t        \"value\": \"cropped\",\n\t        \"domAttr\": \"data-name\"\n\t    }\n\t};\n\tCrop.prototype.reset = function () {\n\t    //Coordinates and Variables\n\t    this.cnv = {\n\t        cursor: { x: 0, y: 0 },\n\t        crop: { x: 0, y: 0, x2: 0, y2: 0, w: 0, h: 0 },\n\t        toSave: { x: 0, y: 0, w: 0, h: 0 },\n\t        image: { w: 0, h: 0 },\n\t        old: {\n\t            cursor: { x: 0, y: 0 }\n\t        },\n\t        start: {\n\t            crop: { x: 0, y: 0, w: 0, h: 0 }\n\t        },\n\t        canvas: { w: 538, h: 0 },\n\t        orig: {},\n\t        preview: { w: 0, h: 0 },\n\t        scale: 1\n\t    };\n\t    this.setTop(0);\n\t    this.setLeft(0);\n\t    this.setWidth(0);\n\t    this.setHeight(0);\n\t\n\t    if (this.els.imageOriginal.lastChild) this.els.imageOriginal.removeChild(this.els.imageOriginal.lastChild);\n\t};\n\t/**\r\n\t * Changes crop info if need.\r\n\t * @param type {string}\r\n\t * @param value {string|number}\r\n\t */\n\tCrop.prototype.changeInfo = function (type, value) {\n\t    switch (type) {\n\t        case \"ratio\":\n\t            this.els.cropInfo.ratio.innerHTML = \"Aspect ratio: \" + value;\n\t            break;\n\t        case \"croppedSize\":\n\t            this.els.cropInfo.croppedSize.innerHTML = \"Cropped size: \" + value[0] + 'x' + value[1];\n\t            break;\n\t        case \"origSize\":\n\t            this.els.cropInfo.origSize.innerHTML = \"Original size: \" + value[0] + 'x' + value[1];\n\t            break;\n\t        default:\n\t            break;\n\t    }\n\t};\n\t/**\r\n\t * Update cropping info.\r\n\t */\n\tCrop.prototype.updateInfo = function () {\n\t    var that = this;\n\t    if (this.options.info.length > 0) {\n\t        this.options.info.forEach(function (info) {\n\t            if (info == \"ratio\") that.changeInfo(\"ratio\", Math.round(that.cnv.crop.w / that.cnv.crop.h * 100) / 100);\n\t            if (info == \"croppedSize\") that.changeInfo(\"croppedSize\", [Math.round(that.cnv.crop.w * that.cnv.scale), Math.round(that.cnv.crop.h * that.cnv.scale)]);\n\t        });\n\t    }\n\t};\n\t/**\r\n\t * Shows modal with cropper\r\n\t */\n\tCrop.prototype.showPopup = function () {\n\t    document.body.appendChild(this.els.modal);\n\t    this.addModalEventListeners();\n\t    this.removeEventListeners();\n\t};\n\t/**\r\n\t * Hides modal with cropper\r\n\t */\n\tCrop.prototype.hidePopup = function () {\n\t    this.els.modal.parentNode.removeChild(this.els.modal);\n\t    this.removeModalEventListeners();\n\t    this.addEventListeners();\n\t};\n\t\n\t/**\r\n\t * Adds static events listeners.\r\n\t */\n\tCrop.prototype.addEventListeners = function () {\n\t    var that = this;\n\t\n\t    this._inputChange = function (e) {\n\t        //IE9 doesn't support File API\n\t        var file = e.target.files[0];\n\t        if (!file.type.match(/image/)) {\n\t            alert(\"Please select an image.\");\n\t            return;\n\t        }\n\t        that.handleFileSelect(file);\n\t        if (that.els.adjust) that.els.adjust.style.display = 'inline-block';\n\t    };\n\t\n\t    this._openCropper = function (e) {\n\t        if (that.img) {\n\t            if (that.readyToPrepare) that.prepare();\n\t            that.showPopup();\n\t        }\n\t    };\n\t\n\t    if (this.els.input) {\n\t        this.els.input.addEventListener('change', this._inputChange);\n\t    }\n\t    if (this.els.preview) {\n\t        this.els.preview.addEventListener('click', this._openCropper);\n\t    }\n\t    if (this.els.adjust) {\n\t        this.els.adjust.addEventListener('click', this._openCropper);\n\t    }\n\t};\n\t\n\tCrop.prototype.removeEventListeners = function () {\n\t    if (this.els.input) {\n\t        this.els.input.removeEventListener('change', this._inputChange);\n\t    }\n\t    if (this.els.preview) {\n\t        this.els.preview.removeEventListener('click', this._openCropper);\n\t    }\n\t    if (this.els.adjust) {\n\t        this.els.adjust.removeEventListener('click', this._openCropper);\n\t    }\n\t};\n\t\n\t/**\r\n\t * Adds events listeners for modal.\r\n\t */\n\tCrop.prototype.addModalEventListeners = function () {\n\t    var that = this;\n\t\n\t    this._cropSave = function () {\n\t        that.save();\n\t        that.hidePopup();\n\t    };\n\t\n\t    this._hidePopup = function () {\n\t        //this fn to save correct \"this\" and to be able to remove listener later\n\t        that.hidePopup();\n\t    };\n\t\n\t    this._cropWrapperMouseDown = function (e) {\n\t        that.onCropStart(e);\n\t        that.inCropping = true;\n\t    };\n\t\n\t    this._documentMouseMove = function (e) {\n\t        if (that.inCropping) {\n\t            e.preventDefault(); //prevent selecting background elements\n\t            that.onCrop(e);\n\t        }\n\t    };\n\t\n\t    this._cropWrapperMouseUp = function () {\n\t        that.onCropEnd();\n\t        that.inCropping = false;\n\t    };\n\t\n\t    this._documentMouseUp = function () {\n\t        that.onCropEnd();\n\t        that.inCropping = false;\n\t    };\n\t    this.els.closePopup.addEventListener(\"click\", this._hidePopup);\n\t    this.els.cropSave.addEventListener(\"click\", this._cropSave);\n\t    this.els.cropWrapper.addEventListener(\"mousedown\", this._cropWrapperMouseDown);\n\t    this.els.cropWrapper.addEventListener(\"mouseup\", this._cropWrapperMouseUp);\n\t    document.addEventListener(\"mousemove\", this._documentMouseMove);\n\t    document.addEventListener(\"mouseup\", this._documentMouseUp);\n\t};\n\t\n\tCrop.prototype.removeModalEventListeners = function () {\n\t    this.els.closePopup.removeEventListener(\"click\", this._hidePopup);\n\t    this.els.cropSave.removeEventListener(\"click\", this._cropSave);\n\t    this.els.cropWrapper.removeEventListener(\"mousedown\", this._cropWrapperMouseDown);\n\t    this.els.cropWrapper.removeEventListener(\"mouseup\", this._cropWrapperMouseUp);\n\t    document.removeEventListener(\"mousemove\", this._documentMouseMove);\n\t    document.removeEventListener(\"mouseup\", this._documentMouseUp);\n\t};\n\t\n\t/**\r\n\t * Sets preview\r\n\t * @param img\r\n\t */\n\tCrop.prototype.setPreviewImage = function (img) {\n\t    var that = this;\n\t    if (that.els.preview) {\n\t        //        if (that.els.preview.lastChild) // Don't remember why was removing only last child\n\t        //            that.els.preview.removeChild(that.els.preview.lastChild);\n\t        while (that.els.preview.firstChild) {\n\t            that.els.preview.removeChild(that.els.preview.firstChild);\n\t        }\n\t        var newimg = img.cloneNode(true);\n\t        newimg.style.maxWidth = \"100%\";\n\t        that.els.preview.appendChild(newimg);\n\t    }\n\t};\n\t/**\r\n\t * Reads file, selected by user\r\n\t * @param file\r\n\t */\n\tCrop.prototype.handleFileSelect = function (file) {\n\t    var that = this;\n\t    this.reader = new FileReader();\n\t    this.reset();\n\t    this.reader.onload = function (theFile) {\n\t        return function (e) {\n\t            that.file = {\n\t                file: theFile,\n\t                blob: theFile,\n\t                name: encodeURIComponent(theFile.name ? theFile.name : that.options.ajaximage.replace(/^.*[\\\\\\/]/, '')),\n\t                base64: e.target.result\n\t            };\n\t            that.img = new Image();\n\t            that.img.src = that.file.base64;\n\t            that.img.onload = function () {\n\t                that.setPreviewImage(that.img);\n\t                that.cnv.preview.h = that.img.clientHeight;\n\t                that.cnv.preview.w = that.img.clientWidth;\n\t                that.cnv.orig.h = that.img.naturalHeight;\n\t                that.cnv.orig.w = that.img.naturalWidth;\n\t                that.cnv.orig.ratio = that.cnv.orig.w / that.cnv.orig.h;\n\t                if (that.cnv.orig.ratio < 1) that.cnv.canvas.w *= that.cnv.orig.ratio; // if image is too narrow -> correct canvas sizes not to exceed display sizes\n\t                that.cnv.scale = that.cnv.orig.w / that.cnv.canvas.w;\n\t                that.cnv.toSave.w = that.cnv.orig.w;\n\t                that.cnv.toSave.h = that.cnv.orig.h;\n\t\n\t                if (that.els.imageOriginal.lastChild) that.els.imageOriginal.removeChild(that.els.imageOriginal.lastChild);\n\t                that.readyToPrepare = true;\n\t                that.options.onFileProcessed();\n\t            };\n\t        };\n\t    }(file);\n\t\n\t    this.reader.readAsDataURL(file);\n\t};\n\t\n\t/**\r\n\t * Prepares canvas, calculates coordinates\r\n\t */\n\tCrop.prototype.prepare = function () {\n\t    var that = this;\n\t    var c = document.createElement(\"canvas\");\n\t    c.width = that.cnv.canvas.w;\n\t    c.height = that.cnv.canvas.w / that.cnv.orig.ratio;\n\t    var ctx = c.getContext(\"2d\");\n\t\n\t    function drawImageOnCanvas() {\n\t        //fix to NS_ERROR_NOT_AVAILABLE in firefox with ctx.drawImage\n\t        try {\n\t            ctx.drawImage(that.img, 0, 0, that.cnv.canvas.w, that.cnv.canvas.w / that.cnv.orig.ratio);\n\t        } catch (e) {\n\t            if (e.name == \"NS_ERROR_NOT_AVAILABLE\") {\n\t                setTimeout(drawImageOnCanvas, 0);\n\t            } else {\n\t                throw e;\n\t            }\n\t        }\n\t    }\n\t\n\t    drawImageOnCanvas();\n\t    that.els.imageOriginal.appendChild(c);\n\t    setTimeout(function () {\n\t        that.cnv.image.w = that.els.imageOriginal.lastChild.clientWidth;\n\t        that.cnv.image.h = that.els.imageOriginal.lastChild.clientHeight;\n\t        that.cnv.start.crop.w = that.cnv.image.w;\n\t        that.cnv.start.crop.h = that.cnv.image.h;\n\t        that.setWidth(that.cnv.image.w);\n\t        that.setHeight(that.cnv.image.h);\n\t        that.cnv.crop.x2 = that.cnv.image.w;\n\t        that.cnv.crop.y2 = that.cnv.image.h;\n\t\n\t        if (that.options.ratio) {\n\t            if (that.cnv.orig.ratio > that.options.ratio) {\n\t                var w = that.cnv.crop.w;\n\t                that.setWidth(Math.round(that.cnv.start.crop.h * that.options.ratio));\n\t                that.cnv.start.crop.w = that.cnv.crop.w;\n\t                that.setLeft(Math.round((w - that.cnv.crop.w) / 2));\n\t                that.cnv.crop.x2 = that.cnv.crop.x + that.cnv.crop.w;\n\t            } else {\n\t                var h = that.cnv.crop.h;\n\t                that.setHeight(Math.round(that.cnv.start.crop.w / that.options.ratio));\n\t                that.cnv.start.crop.h = that.cnv.crop.h;\n\t                that.setTop(Math.round((h - that.cnv.crop.h) / 2));\n\t                that.cnv.crop.y2 = that.cnv.crop.y + that.cnv.crop.h;\n\t            }\n\t\n\t            that.save();\n\t        }\n\t        that.updateInfo();\n\t        if (that.options.info.indexOf(\"origSize\") > -1) {\n\t            that.changeInfo(\"origSize\", [that.cnv.orig.w, that.cnv.orig.h]); //no need to pass through updateInfo since it's static\n\t        }\n\t\n\t        that.readyToPrepare = false;\n\t    }, 50);\n\t};\n\t\n\t/**\r\n\t * Processes crop start.\r\n\t * @param {Event} e\r\n\t */\n\tCrop.prototype.onCropStart = function (e) {\n\t    this.els.handlers.current = e.target;\n\t    this.cnv.offset = this.els.cropWrapper.getBoundingClientRect();\n\t    this.cnv.cursor.x = Math.round(e.clientX - this.cnv.offset.left);\n\t    this.cnv.cursor.y = Math.round(e.clientY - this.cnv.offset.top);\n\t    this.cnv.cursor.offsetX = e.offsetX === undefined ? Math.round(e.layerX) : Math.round(e.offsetX);\n\t    this.cnv.cursor.offsetY = e.offsetY === undefined ? Math.round(e.layerY) : Math.round(e.offsetY);\n\t};\n\t\n\t/**\r\n\t * Processes cropping (mouse move)\r\n\t * @param  {Event} e\r\n\t */\n\tCrop.prototype.onCrop = function (e) {\n\t    if (!this.els.handlers.current) return;\n\t    this.cnv.cursor.x = Math.round(e.clientX - this.cnv.offset.left);\n\t    this.cnv.cursor.y = Math.round(e.clientY - this.cnv.offset.top);\n\t    switch (this.els.handlers.current) {\n\t        case this.els.handlers.n:\n\t            this.setN();\n\t            break;\n\t        case this.els.handlers.ne:\n\t            this.setNE();\n\t            break;\n\t        case this.els.handlers.e:\n\t            this.setE();\n\t            break;\n\t        case this.els.handlers.se:\n\t            this.setSE();\n\t            break;\n\t        case this.els.handlers.s:\n\t            this.setS();\n\t            break;\n\t        case this.els.handlers.sw:\n\t            this.setSW();\n\t            break;\n\t        case this.els.handlers.w:\n\t            this.setW();\n\t            break;\n\t        case this.els.handlers.nw:\n\t            this.setNW();\n\t            break;\n\t        case this.els.cropElements:\n\t            this.move();\n\t            break;\n\t    }\n\t    this.updateInfo();\n\t};\n\t\n\t/**\r\n\t * Process crop end.\r\n\t */\n\tCrop.prototype.onCropEnd = function () {\n\t    this.els.handlers.current = null;\n\t};\n\t/**\r\n\t * Sets left side of cropper\r\n\t * @param x {number}\r\n\t */\n\tCrop.prototype.setLeft = function (x) {\n\t    this.cnv.crop.x = x;\n\t    this.els.cropElements.style.left = x + \"px\";\n\t    this.els.dimmers.el.style.left = x + \"px\";\n\t};\n\t/**\r\n\t * Sets top side of cropper\r\n\t * @param y {number}\r\n\t */\n\tCrop.prototype.setTop = function (y) {\n\t    this.cnv.crop.y = y;\n\t    this.els.cropElements.style.top = y + \"px\";\n\t    this.els.dimmers.el.style.top = y + \"px\";\n\t};\n\t/**\r\n\t * Sets width of cropper\r\n\t * @param w {number}\r\n\t */\n\tCrop.prototype.setWidth = function (w) {\n\t    this.cnv.crop.w = w;\n\t    this.els.cropElements.style.width = w + \"px\";\n\t    this.els.dimmers.el.style.width = w + \"px\";\n\t};\n\t/**\r\n\t * Sets height of cropper\r\n\t * @param h {number}\r\n\t */\n\tCrop.prototype.setHeight = function (h) {\n\t    this.cnv.crop.h = h;\n\t    this.els.cropElements.style.height = h + \"px\";\n\t    this.els.dimmers.el.style.height = h + \"px\";\n\t};\n\t\n\t/**\r\n\t * Adjusts coordinates.\r\n\t * @param {boolean|undefined} notDefaultSide\r\n\t * @param {number} y\r\n\t */\n\tCrop.prototype.adjustN = function (notDefaultSide, y) {\n\t    if (notDefaultSide) {\n\t        if ((this.cnv.crop.y2 - y) * this.options.ratio <= this.cnv.crop.x2) {\n\t            this.setTop(y);\n\t            this.setHeight(this.cnv.crop.y2 - y);\n\t            this.setWidth(Math.round(this.cnv.crop.h * this.options.ratio));\n\t            this.setLeft(this.cnv.crop.x2 - this.cnv.crop.w);\n\t        } else {\n\t            this.setLeft(0);\n\t            this.setWidth(this.cnv.crop.x2);\n\t            this.setTop(this.cnv.crop.y2 - Math.round(this.cnv.crop.w / this.options.ratio));\n\t        }\n\t    } else {\n\t        if ((this.cnv.crop.y2 - y) * this.options.ratio + this.cnv.crop.x <= this.cnv.image.w) {\n\t            this.setTop(y);\n\t            this.setHeight(this.cnv.crop.y2 - y);\n\t            this.setWidth(Math.round(this.cnv.crop.h * this.options.ratio));\n\t            this.cnv.crop.x2 = this.cnv.crop.x + this.cnv.crop.w;\n\t        } else {\n\t            this.setWidth(this.cnv.image.w - this.cnv.crop.x);\n\t            this.setTop(this.cnv.crop.y2 - Math.round(this.cnv.crop.w / this.options.ratio));\n\t            this.setHeight(this.cnv.crop.y2 - this.cnv.crop.y);\n\t            this.cnv.crop.x2 = this.cnv.image.w;\n\t        }\n\t    }\n\t};\n\t\n\t/**\r\n\t * Sets top coordinates and border.\r\n\t * @param {Boolean} [notDefaultSide]\r\n\t */\n\tCrop.prototype.setN = function (notDefaultSide) {\n\t    if (this.options.ratio) {\n\t        if (this.cnv.cursor.y > 0) {\n\t            if (this.cnv.cursor.y < this.cnv.crop.y2) {\n\t                this.adjustN(notDefaultSide, this.cnv.cursor.y);\n\t            } else {\n\t                this.setHeight(1);\n\t                this.setWidth(Math.round(this.cnv.crop.h * this.options.ratio));\n\t                if (notDefaultSide) {\n\t                    this.setLeft(this.cnv.crop.x2 - 1);\n\t                } else {\n\t                    this.cnv.crop.x2 = this.cnv.crop.x + this.cnv.crop.w;\n\t                }\n\t                this.setTop(this.cnv.crop.y2 - 1);\n\t            }\n\t        } else {\n\t            this.adjustN(notDefaultSide, 0);\n\t        }\n\t    } else {\n\t        if (this.cnv.cursor.y > 0) {\n\t            if (this.cnv.cursor.y < this.cnv.crop.y2) {\n\t                this.setTop(this.cnv.cursor.y);\n\t                this.setHeight(this.cnv.crop.y2 - this.cnv.crop.y);\n\t            } else {\n\t                this.setTop(this.cnv.crop.y2 - 1);\n\t                this.setHeight(1);\n\t            }\n\t        } else {\n\t            this.setTop(0);\n\t            this.setHeight(this.cnv.crop.y2);\n\t        }\n\t    }\n\t};\n\t\n\t/**\r\n\t * Adjusts coordinates.\r\n\t * @param {boolean|undefined} notDefaultSide\r\n\t * @param {number} y2\r\n\t */\n\tCrop.prototype.adjustS = function (notDefaultSide, y2) {\n\t    if (notDefaultSide) {\n\t        if ((y2 - this.cnv.crop.y) * this.options.ratio <= this.cnv.crop.x2) {\n\t            this.setHeight(y2 - this.cnv.crop.y);\n\t            this.setWidth(Math.round(this.cnv.crop.h * this.options.ratio));\n\t            this.setLeft(this.cnv.crop.x2 - this.cnv.crop.w);\n\t            this.cnv.crop.y2 = y2;\n\t        } else {\n\t            this.setLeft(0);\n\t            this.setWidth(this.cnv.crop.x2);\n\t            this.setHeight(Math.round(this.cnv.crop.w / this.options.ratio));\n\t            this.cnv.crop.y2 = this.cnv.crop.y + this.cnv.crop.h;\n\t        }\n\t    } else {\n\t        if ((y2 - this.cnv.crop.y) * this.options.ratio + this.cnv.crop.x <= this.cnv.image.w) {\n\t            this.setHeight(y2 - this.cnv.crop.y);\n\t            this.setWidth(Math.round(this.cnv.crop.h * this.options.ratio));\n\t            this.cnv.crop.y2 = y2;\n\t            this.cnv.crop.x2 = this.cnv.crop.x + this.cnv.crop.w;\n\t        } else {\n\t            this.setWidth(this.cnv.image.w - this.cnv.crop.x);\n\t            this.setHeight(Math.round(this.cnv.crop.w / this.options.ratio));\n\t            this.cnv.crop.x2 = this.cnv.image.w;\n\t            this.cnv.crop.y2 = this.cnv.crop.y + this.cnv.crop.h;\n\t        }\n\t    }\n\t};\n\t\n\t/**\r\n\t * Sets bottom coordinates and border.\r\n\t * @param {Boolean} [notDefaultSide]\r\n\t */\n\tCrop.prototype.setS = function (notDefaultSide) {\n\t    if (this.options.ratio) {\n\t        if (this.cnv.cursor.y < this.cnv.image.h) {\n\t            if (this.cnv.cursor.y > this.cnv.crop.y) {\n\t                this.adjustS(notDefaultSide, this.cnv.cursor.y);\n\t            } else {\n\t                this.setHeight(1);\n\t                this.setWidth(Math.round(this.cnv.crop.h * this.options.ratio));\n\t                if (notDefaultSide) {\n\t                    this.setLeft(this.cnv.crop.x2 - 1);\n\t                } else {\n\t                    this.cnv.crop.x2 = this.cnv.crop.x + this.cnv.crop.w;\n\t                }\n\t                this.cnv.crop.y2 = this.cnv.crop.y + 1;\n\t            }\n\t        } else {\n\t            this.adjustS(notDefaultSide, this.cnv.image.h);\n\t        }\n\t    } else {\n\t        if (this.cnv.cursor.y < this.cnv.image.h) {\n\t            if (this.cnv.cursor.y > this.cnv.crop.y) {\n\t                this.setHeight(this.cnv.cursor.y - this.cnv.crop.y);\n\t                this.cnv.crop.y2 = this.cnv.cursor.y;\n\t            } else {\n\t                this.setHeight(1);\n\t                this.cnv.crop.y2 = this.cnv.crop.y + 1;\n\t            }\n\t        } else {\n\t            this.setHeight(this.cnv.image.h - this.cnv.crop.y);\n\t            this.cnv.crop.y2 = this.cnv.image.h;\n\t        }\n\t    }\n\t};\n\t\n\t/**\r\n\t * Adjusts coordinates.\r\n\t * @param {boolean|undefined} notDefaultSide\r\n\t * @param {number} x\r\n\t */\n\tCrop.prototype.adjustW = function (notDefaultSide, x) {\n\t    if (notDefaultSide) {\n\t        if (this.cnv.crop.y2 - (this.cnv.crop.x2 - x) / this.options.ratio >= 0) {\n\t            this.setLeft(x);\n\t            this.setWidth(this.cnv.crop.x2 - x);\n\t            this.setHeight(Math.round(this.cnv.crop.w / this.options.ratio));\n\t            this.setTop(this.cnv.crop.y2 - this.cnv.crop.h);\n\t        } else {\n\t            this.setTop(0);\n\t            this.setHeight(this.cnv.crop.y2);\n\t            this.setWidth(Math.round(this.cnv.crop.h * this.options.ratio));\n\t            this.setLeft(this.cnv.crop.x2 - this.cnv.crop.w);\n\t        }\n\t    } else {\n\t        if ((this.cnv.crop.x2 - x) / this.options.ratio + this.cnv.crop.y <= this.cnv.image.h) {\n\t            this.setLeft(x);\n\t            this.setWidth(this.cnv.crop.x2 - x);\n\t            this.setHeight(Math.round(this.cnv.crop.w / this.options.ratio));\n\t            this.cnv.crop.y2 = this.cnv.crop.y + this.cnv.crop.h;\n\t        } else {\n\t            this.setHeight(this.cnv.image.h - this.cnv.crop.y);\n\t            this.setWidth(Math.round(this.cnv.crop.h * this.options.ratio));\n\t            this.setLeft(this.cnv.crop.x2 - this.cnv.crop.w);\n\t            this.cnv.crop.y2 = this.cnv.image.h;\n\t        }\n\t    }\n\t};\n\t\n\t/**\r\n\t * Sets left coordinates and border.\r\n\t * @param {Boolean} [notDefaultSide]\r\n\t */\n\tCrop.prototype.setW = function (notDefaultSide) {\n\t    if (this.options.ratio) {\n\t        if (this.cnv.cursor.x > 0) {\n\t            if (this.cnv.cursor.x < this.cnv.crop.x2) {\n\t                this.adjustW(notDefaultSide, this.cnv.cursor.x);\n\t            } else {\n\t                this.setWidth(1);\n\t                this.setHeight(Math.round(this.cnv.crop.w / this.options.ratio));\n\t                if (notDefaultSide) {\n\t                    this.setTop(this.cnv.crop.y2 - 1);\n\t                } else {\n\t                    this.cnv.crop.y2 = this.cnv.crop.y + this.cnv.crop.h;\n\t                }\n\t            }\n\t        } else {\n\t            this.adjustW(notDefaultSide, 0);\n\t        }\n\t    } else {\n\t        if (this.cnv.cursor.x > 0) {\n\t            if (this.cnv.cursor.x < this.cnv.crop.x2) {\n\t                this.setLeft(this.cnv.cursor.x);\n\t                this.setWidth(this.cnv.crop.x2 - this.cnv.crop.x);\n\t            } else {\n\t                this.setLeft(this.cnv.crop.x2 - 1);\n\t                this.setWidth(1);\n\t            }\n\t        } else {\n\t            this.setLeft(0);\n\t            this.setWidth(this.cnv.crop.x2);\n\t        }\n\t    }\n\t};\n\t\n\t/**\r\n\t * Adjusts coordinates.\r\n\t * @param {boolean|undefined} notDefaultSide\r\n\t * @param {number} x\r\n\t */\n\tCrop.prototype.adjustE = function (notDefaultSide, x) {\n\t    if (notDefaultSide) {\n\t        if (this.cnv.crop.y2 - (x - this.cnv.crop.x) / this.options.ratio >= 0) {\n\t            this.setWidth(x - this.cnv.crop.x);\n\t            this.setHeight(Math.round(this.cnv.crop.w / this.options.ratio));\n\t            this.setTop(this.cnv.crop.y2 - this.cnv.crop.h);\n\t            this.cnv.crop.x2 = x;\n\t        } else {\n\t            this.setTop(0);\n\t            this.setHeight(this.cnv.crop.y2);\n\t            this.setWidth(Math.round(this.cnv.crop.h * this.options.ratio));\n\t            this.cnv.crop.x2 = this.cnv.crop.x + this.cnv.crop.w;\n\t        }\n\t    } else {\n\t        if ((x - this.cnv.crop.x) / this.options.ratio + this.cnv.crop.y <= this.cnv.image.h) {\n\t            this.setWidth(x - this.cnv.crop.x);\n\t            this.setHeight(Math.round(this.cnv.crop.w / this.options.ratio));\n\t            this.cnv.crop.x2 = x;\n\t            this.cnv.crop.y2 = this.cnv.crop.y + this.cnv.crop.h;\n\t        } else {\n\t            this.setHeight(this.cnv.image.h - this.cnv.crop.y);\n\t            this.setWidth(Math.round(this.cnv.crop.h * this.options.ratio));\n\t            this.cnv.crop.y2 = this.cnv.image.h;\n\t            this.cnv.crop.x2 = this.cnv.crop.x + this.cnv.crop.w;\n\t        }\n\t    }\n\t};\n\t\n\t/**\r\n\t * Sets right coordinates and border.\r\n\t * @param {Boolean} [notDefaultSide]\r\n\t */\n\tCrop.prototype.setE = function (notDefaultSide) {\n\t    if (this.options.ratio) {\n\t        if (this.cnv.cursor.x < this.cnv.image.w) {\n\t            if (this.cnv.cursor.x > this.cnv.crop.x) {\n\t                this.adjustE(notDefaultSide, this.cnv.cursor.x);\n\t            } else {\n\t                this.setWidth(1);\n\t                this.setHeight(Math.round(this.cnv.crop.w / this.options.ratio));\n\t                if (notDefaultSide) {\n\t                    this.setTop(this.cnv.crop.y2 - 1);\n\t                } else {\n\t                    this.cnv.crop.y2 = this.cnv.crop.y + this.cnv.crop.h;\n\t                }\n\t                this.cnv.crop.x2 = this.cnv.crop.x + 1;\n\t            }\n\t        } else {\n\t            this.adjustE(notDefaultSide, this.cnv.image.w);\n\t        }\n\t    } else {\n\t        if (this.cnv.cursor.x < this.cnv.image.w) {\n\t            if (this.cnv.cursor.x > this.cnv.crop.x) {\n\t                this.setWidth(this.cnv.cursor.x - this.cnv.crop.x);\n\t                this.cnv.crop.x2 = this.cnv.cursor.x;\n\t            } else {\n\t                this.setWidth(1);\n\t                this.cnv.crop.x2 = this.cnv.crop.x + 1;\n\t            }\n\t        } else {\n\t            this.setWidth(this.cnv.image.w - this.cnv.crop.x);\n\t            this.cnv.crop.x2 = this.cnv.image.w;\n\t        }\n\t    }\n\t};\n\t\n\t/**\r\n\t * Sets top-right corner.\r\n\t */\n\tCrop.prototype.setNE = function () {\n\t    if (this.options.ratio) {\n\t        if (Math.abs(this.cnv.cursor.x - this.cnv.crop.x2) > Math.abs(this.cnv.cursor.y - this.cnv.crop.y) && this.cnv.cursor.x <= this.cnv.crop.x2) {\n\t            this.setN();\n\t        } else {\n\t            this.cnv.cursor.y >= this.cnv.crop.y ? this.setE(true) : this.setN();\n\t        }\n\t    } else {\n\t        this.setN();\n\t        this.setE();\n\t    }\n\t};\n\t\n\t/**\r\n\t * Sets bottom-right corner.\r\n\t */\n\tCrop.prototype.setSE = function () {\n\t    if (this.options.ratio) {\n\t        if (Math.abs(this.cnv.cursor.x - this.cnv.crop.x2) > Math.abs(this.cnv.cursor.y - this.cnv.crop.y - this.cnv.crop.h) && this.cnv.cursor.x <= this.cnv.crop.x2) {\n\t            this.setS();\n\t        } else {\n\t            this.cnv.cursor.y <= this.cnv.crop.y + this.cnv.crop.h ? this.setE() : this.setS();\n\t        }\n\t    } else {\n\t        this.setS();\n\t        this.setE();\n\t    }\n\t};\n\t\n\t/**\r\n\t * Sets bottom-left corner.\r\n\t */\n\tCrop.prototype.setSW = function () {\n\t    if (this.options.ratio) {\n\t        if (Math.abs(this.cnv.cursor.x - this.cnv.crop.x) > Math.abs(this.cnv.cursor.y - this.cnv.crop.y - this.cnv.crop.h) && this.cnv.cursor.x >= this.cnv.crop.x) {\n\t            this.setS(true);\n\t        } else {\n\t            this.cnv.cursor.y <= this.cnv.crop.y + this.cnv.crop.h ? this.setW() : this.setS(true);\n\t        }\n\t    } else {\n\t        this.setS();\n\t        this.setW();\n\t    }\n\t};\n\t\n\t/**\r\n\t * Sets top-left corner.\r\n\t */\n\tCrop.prototype.setNW = function () {\n\t    if (this.options.ratio) {\n\t        if (Math.abs(this.cnv.cursor.x - this.cnv.crop.x) > Math.abs(this.cnv.cursor.y - this.cnv.crop.y) && this.cnv.cursor.x >= this.cnv.crop.x) {\n\t            this.setN(true);\n\t        } else {\n\t            this.cnv.cursor.y >= this.cnv.crop.y ? this.setW(true) : this.setN(true);\n\t        }\n\t    } else {\n\t        this.setN();\n\t        this.setW();\n\t    }\n\t};\n\t\n\t/**\r\n\t * Processes move crop selection.\r\n\t */\n\tCrop.prototype.move = function () {\n\t    var left = this.cnv.cursor.x - this.cnv.cursor.offsetX;\n\t    var top = this.cnv.cursor.y - this.cnv.cursor.offsetY;\n\t    if (left > 0) {\n\t        if (left + this.cnv.crop.w < this.cnv.image.w) {\n\t            this.setLeft(left);\n\t        } else {\n\t            this.setLeft(this.cnv.image.w - this.cnv.crop.w);\n\t        }\n\t    } else {\n\t        this.setLeft(0);\n\t    }\n\t\n\t    if (top > 0) {\n\t        if (top + this.cnv.crop.h < this.cnv.image.h) {\n\t            this.setTop(top);\n\t        } else {\n\t            this.setTop(this.cnv.image.h - this.cnv.crop.h);\n\t        }\n\t    } else {\n\t        this.setTop(0);\n\t    }\n\t\n\t    this.cnv.crop.x2 = this.cnv.crop.x + this.cnv.crop.w;\n\t    this.cnv.crop.y2 = this.cnv.crop.y + this.cnv.crop.h;\n\t};\n\t\n\t/**\r\n\t * Converts dataURI to Blob.\r\n\t * http://stackoverflow.com/questions/4998908/convert-data-uri-to-file-then-append-to-formdata\r\n\t * @param dataURI\r\n\t * @returns {Blob}\r\n\t */\n\tCrop.prototype.dataURItoBlob = function (dataURI) {\n\t\n\t    var content = [],\n\t        byteString,\n\t        mimeString;\n\t\n\t    if (dataURI.split(',')[0].indexOf('base64') !== -1) {\n\t        byteString = atob(dataURI.split(',')[1]);\n\t    } else {\n\t        byteString = decodeURI(dataURI.split(',')[1]);\n\t    }\n\t\n\t    mimeString = dataURI.split(',')[0].split(':')[1].split(';')[0];\n\t\n\t    for (var i = 0; i < byteString.length; i++) {\n\t        content[i] = byteString.charCodeAt(i);\n\t    }\n\t\n\t    return new Blob([new Uint8Array(content)], { type: mimeString });\n\t};\n\t\n\t/**\r\n\t * Saves results to preview.\r\n\t */\n\tCrop.prototype.save = function () {\n\t    'use strict';\n\t\n\t    var that = this;\n\t    var c = document.createElement(\"canvas\"),\n\t        ctx = c.getContext(\"2d\"),\n\t        img;\n\t    this.cnv.toSave = { //CoordinateS\n\t        w: Math.round(this.cnv.crop.w * this.cnv.scale),\n\t        h: Math.round(this.cnv.crop.h * this.cnv.scale),\n\t        x: Math.round(this.cnv.crop.x * this.cnv.scale),\n\t        y: Math.round(this.cnv.crop.y * this.cnv.scale)\n\t    };\n\t\n\t    c.width = this.cnv.toSave.w;\n\t    c.height = this.cnv.toSave.h;\n\t\n\t    function drawImageOnCanvas() {\n\t        //TODO refactor this piece. Almost the same as in prepare().\n\t        try {\n\t            ctx.drawImage(that.img, that.cnv.toSave.x, that.cnv.toSave.y, that.cnv.toSave.w, that.cnv.toSave.h, 0, 0, that.cnv.toSave.w, that.cnv.toSave.h);\n\t        } catch (e) {\n\t            if (e.name == \"NS_ERROR_NOT_AVAILABLE\") {\n\t                setTimeout(drawImageOnCanvas, 0);\n\t            } else {\n\t                throw e;\n\t            }\n\t        }\n\t    }\n\t\n\t    drawImageOnCanvas();\n\t    this.strDataURI = c.toDataURL(\"image/jpeg\", 0.95);\n\t\n\t    img = new Image();\n\t    img.src = this.strDataURI;\n\t\n\t    this.setPreviewImage(img);\n\t    this.file.blob = this.dataURItoBlob(this.strDataURI);\n\t};\n\t\n\t/**\r\n\t * Attaches data to formData\r\n\t */\n\tCrop.prototype.attachData = function () {\n\t    var that = this;\n\t    if (this.form) {\n\t        if (this.options.format == \"cropped\") {\n\t            this.form.events.on(\"beforeSend\", function (options) {\n\t                options.data.append(that.options.name, that.file.blob, that.file.name);\n\t            });\n\t        } else {\n\t            this.form.events.on(\"beforeSend\", function (options) {\n\t                options.data.append(that.options.name, that.file.file, that.file.name);\n\t                options.data.append(that.options.name + \"-cropData[cropWidth]\", that.cnv.toSave.w);\n\t                options.data.append(that.options.name + \"-cropData[cropHeight]\", that.cnv.toSave.h);\n\t                options.data.append(that.options.name + \"-cropData[cropX]\", that.cnv.toSave.x);\n\t                options.data.append(that.options.name + \"-cropData[cropY]\", that.cnv.toSave.y);\n\t            });\n\t        }\n\t    }\n\t};\n\t\n\tCrop.prototype.die = function () {\n\t    this.removeEventListeners();\n\t    this.removeModalEventListeners();\n\t    delete this;\n\t};\n\t\n\texports.default = Crop;\n\n/***/ },\n/* 3 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tmodule.exports = { \"default\": __webpack_require__(4), __esModule: true };\n\n/***/ },\n/* 4 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar $ = __webpack_require__(5);\n\tmodule.exports = function create(P, D) {\n\t  return $.create(P, D);\n\t};\n\n/***/ },\n/* 5 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tvar $Object = Object;\n\tmodule.exports = {\n\t  create: $Object.create,\n\t  getProto: $Object.getPrototypeOf,\n\t  isEnum: {}.propertyIsEnumerable,\n\t  getDesc: $Object.getOwnPropertyDescriptor,\n\t  setDesc: $Object.defineProperty,\n\t  setDescs: $Object.defineProperties,\n\t  getKeys: $Object.keys,\n\t  getNames: $Object.getOwnPropertyNames,\n\t  getSymbols: $Object.getOwnPropertySymbols,\n\t  each: [].forEach\n\t};\n\n/***/ },\n/* 6 */\n/***/ function(module, exports) {\n\n\tmodule.exports = \"<div class=sf-crop-modal><div class=sf-crop-modal-header><button class=sf-crop-close>×</button><div class=sf-crop-cropper-info><div class=sf-crop-ratio></div><div class=sf-crop-orig-size></div><div class=sf-crop-cropped-size></div></div></div><div class=sf-crop-modal-body><div class=sf-crop-container><div class=sf-crop-image-original></div><div class=sf-crop-wrapper><div class=sf-crop-dimmers-container><div class=dimmers><div class=\\\"dimmer dimmer-N\\\"></div><div class=\\\"dimmer dimmer-E\\\"></div><div class=\\\"dimmer dimmer-S\\\"></div><div class=\\\"dimmer dimmer-W\\\"></div></div></div><div class=sf-crop-elements><div class=\\\"handler handler-N\\\"></div><div class=\\\"handler handler-NE\\\"></div><div class=\\\"handler handler-E\\\"></div><div class=\\\"handler handler-SE\\\"></div><div class=\\\"handler handler-S\\\"></div><div class=\\\"handler handler-SW\\\"></div><div class=\\\"handler handler-W\\\"></div><div class=\\\"handler handler-NW\\\"></div></div></div></div></div><div class=sf-crop-modal-footer><br><button type=button class=\\\"btn sf-crop-save\\\">Save changes</button></div></div>\";\n\n/***/ },\n/* 7 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t// style-loader: Adds some css to the DOM by adding a <style> tag\n\t\n\t// load the styles\n\tvar content = __webpack_require__(8);\n\tif(typeof content === 'string') content = [[module.id, content, '']];\n\t// add the styles to the DOM\n\tvar update = __webpack_require__(10)(content, {});\n\tif(content.locals) module.exports = content.locals;\n\t// Hot Module Replacement\n\tif(false) {\n\t\t// When the styles change, update the <style> tags\n\t\tif(!content.locals) {\n\t\t\tmodule.hot.accept(\"!!./../node_modules/css-loader/index.js?minimize!./../node_modules/less-loader/index.js!./crop.less\", function() {\n\t\t\t\tvar newContent = require(\"!!./../node_modules/css-loader/index.js?minimize!./../node_modules/less-loader/index.js!./crop.less\");\n\t\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\t\tupdate(newContent);\n\t\t\t});\n\t\t}\n\t\t// When the module is disposed, remove the <style> tags\n\t\tmodule.hot.dispose(function() { update(); });\n\t}\n\n/***/ },\n/* 8 */\n/***/ function(module, exports, __webpack_require__) {\n\n\texports = module.exports = __webpack_require__(9)();\n\t// imports\n\t\n\t\n\t// module\n\texports.push([module.id, \".sf-crop-modal{position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);padding:20px;background-color:#fff;box-shadow:0 0 3px #000;overflow:auto;z-index:1000;width:auto;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.sf-crop-modal .sf-crop-save{display:block;margin:0 auto;border-width:0;border-radius:2px;box-shadow:0 1px 2px rgba(0,0,0,.6);background-color:#468ebe;color:#ecf0f1;transition:background-color .3s}.sf-crop-modal .sf-crop-save:focus,.sf-crop-modal .sf-crop-save:hover{background-color:#2778ae}.sf-crop-modal .sf-crop-container{position:relative}.sf-crop-modal .sf-crop-container canvas{display:block}.sf-crop-modal .sf-crop-wrapper{position:absolute;top:0;bottom:0;left:0;right:0}.sf-crop-modal .sf-crop-wrapper .sf-crop-elements{position:absolute;border:1px dashed #000;top:0;width:100%;height:100%;max-width:100%;max-height:100%;cursor:move}.sf-crop-modal .sf-crop-wrapper .sf-crop-dimmers-container{position:absolute;overflow:hidden;top:0;bottom:0;left:0;right:0}.sf-crop-modal .sf-crop-wrapper .dimmers{position:absolute}.sf-crop-modal .sf-crop-wrapper .dimmer{position:absolute;width:1000px;height:1000px;background-color:#000;opacity:.3}.sf-crop-modal .sf-crop-wrapper .dimmer.dimmer-N{bottom:100%;left:0}.sf-crop-modal .sf-crop-wrapper .dimmer.dimmer-E{left:100%;top:0}.sf-crop-modal .sf-crop-wrapper .dimmer.dimmer-S{top:100%;right:0}.sf-crop-modal .sf-crop-wrapper .dimmer.dimmer-W{bottom:0;right:100%}.sf-crop-modal .sf-crop-wrapper .handler{position:absolute;border:1px solid #333;width:10px;height:10px;background:#fff;opacity:.5}.sf-crop-modal .sf-crop-wrapper .handler.handler-N{top:0;left:50%;margin-top:-6px;margin-left:-6px;cursor:n-resize}.sf-crop-modal .sf-crop-wrapper .handler.handler-NE{top:0;right:0;margin-top:-6px;margin-right:-6px;cursor:ne-resize}.sf-crop-modal .sf-crop-wrapper .handler.handler-E{top:50%;right:0;margin-top:-6px;margin-right:-6px;cursor:e-resize}.sf-crop-modal .sf-crop-wrapper .handler.handler-SE{bottom:0;right:0;margin-bottom:-6px;margin-right:-6px;cursor:se-resize}.sf-crop-modal .sf-crop-wrapper .handler.handler-S{bottom:0;left:50%;margin-bottom:-6px;margin-left:-6px;cursor:s-resize}.sf-crop-modal .sf-crop-wrapper .handler.handler-SW{bottom:0;left:0;margin-bottom:-6px;margin-left:-6px;cursor:sw-resize}.sf-crop-modal .sf-crop-wrapper .handler.handler-W{top:50%;left:0;margin-top:-6px;margin-left:-6px;cursor:w-resize}.sf-crop-modal .sf-crop-wrapper .handler.handler-NW{top:0;left:0;margin-top:-6px;margin-left:-6px;cursor:nw-resize}.sf-crop-modal .sf-crop-modal-header{margin-bottom:20px}.sf-crop-modal .sf-crop-modal-header .sf-crop-cropper-info{font-size:12px}.sf-crop-modal .sf-crop-modal-header .sf-crop-close{position:absolute;background:transparent;padding:0;top:10px;right:15px;font-size:24px;border:none;opacity:.2;cursor:pointer}.sf-crop-modal .sf-crop-modal-header .sf-crop-close:hover{opacity:1}\", \"\"]);\n\t\n\t// exports\n\n\n/***/ },\n/* 9 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\t/*\r\n\t\tMIT License http://www.opensource.org/licenses/mit-license.php\r\n\t\tAuthor Tobias Koppers @sokra\r\n\t*/\n\t// css base code, injected by the css-loader\n\tmodule.exports = function () {\n\t\tvar list = [];\n\t\n\t\t// return the list of modules as css string\n\t\tlist.toString = function toString() {\n\t\t\tvar result = [];\n\t\t\tfor (var i = 0; i < this.length; i++) {\n\t\t\t\tvar item = this[i];\n\t\t\t\tif (item[2]) {\n\t\t\t\t\tresult.push(\"@media \" + item[2] + \"{\" + item[1] + \"}\");\n\t\t\t\t} else {\n\t\t\t\t\tresult.push(item[1]);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn result.join(\"\");\n\t\t};\n\t\n\t\t// import a list of modules into the list\n\t\tlist.i = function (modules, mediaQuery) {\n\t\t\tif (typeof modules === \"string\") modules = [[null, modules, \"\"]];\n\t\t\tvar alreadyImportedModules = {};\n\t\t\tfor (var i = 0; i < this.length; i++) {\n\t\t\t\tvar id = this[i][0];\n\t\t\t\tif (typeof id === \"number\") alreadyImportedModules[id] = true;\n\t\t\t}\n\t\t\tfor (i = 0; i < modules.length; i++) {\n\t\t\t\tvar item = modules[i];\n\t\t\t\t// skip already imported module\n\t\t\t\t// this implementation is not 100% perfect for weird media query combinations\n\t\t\t\t//  when a module is imported multiple times with different media queries.\n\t\t\t\t//  I hope this will never occur (Hey this way we have smaller bundles)\n\t\t\t\tif (typeof item[0] !== \"number\" || !alreadyImportedModules[item[0]]) {\n\t\t\t\t\tif (mediaQuery && !item[2]) {\n\t\t\t\t\t\titem[2] = mediaQuery;\n\t\t\t\t\t} else if (mediaQuery) {\n\t\t\t\t\t\titem[2] = \"(\" + item[2] + \") and (\" + mediaQuery + \")\";\n\t\t\t\t\t}\n\t\t\t\t\tlist.push(item);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\treturn list;\n\t};\n\n/***/ },\n/* 10 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t/*\r\n\t\tMIT License http://www.opensource.org/licenses/mit-license.php\r\n\t\tAuthor Tobias Koppers @sokra\r\n\t*/\r\n\tvar stylesInDom = {},\r\n\t\tmemoize = function(fn) {\r\n\t\t\tvar memo;\r\n\t\t\treturn function () {\r\n\t\t\t\tif (typeof memo === \"undefined\") memo = fn.apply(this, arguments);\r\n\t\t\t\treturn memo;\r\n\t\t\t};\r\n\t\t},\r\n\t\tisOldIE = memoize(function() {\r\n\t\t\treturn /msie [6-9]\\b/.test(window.navigator.userAgent.toLowerCase());\r\n\t\t}),\r\n\t\tgetHeadElement = memoize(function () {\r\n\t\t\treturn document.head || document.getElementsByTagName(\"head\")[0];\r\n\t\t}),\r\n\t\tsingletonElement = null,\r\n\t\tsingletonCounter = 0,\r\n\t\tstyleElementsInsertedAtTop = [];\r\n\t\r\n\tmodule.exports = function(list, options) {\r\n\t\tif(false) {\r\n\t\t\tif(typeof document !== \"object\") throw new Error(\"The style-loader cannot be used in a non-browser environment\");\r\n\t\t}\r\n\t\r\n\t\toptions = options || {};\r\n\t\t// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\r\n\t\t// tags it will allow on a page\r\n\t\tif (typeof options.singleton === \"undefined\") options.singleton = isOldIE();\r\n\t\r\n\t\t// By default, add <style> tags to the bottom of <head>.\r\n\t\tif (typeof options.insertAt === \"undefined\") options.insertAt = \"bottom\";\r\n\t\r\n\t\tvar styles = listToStyles(list);\r\n\t\taddStylesToDom(styles, options);\r\n\t\r\n\t\treturn function update(newList) {\r\n\t\t\tvar mayRemove = [];\r\n\t\t\tfor(var i = 0; i < styles.length; i++) {\r\n\t\t\t\tvar item = styles[i];\r\n\t\t\t\tvar domStyle = stylesInDom[item.id];\r\n\t\t\t\tdomStyle.refs--;\r\n\t\t\t\tmayRemove.push(domStyle);\r\n\t\t\t}\r\n\t\t\tif(newList) {\r\n\t\t\t\tvar newStyles = listToStyles(newList);\r\n\t\t\t\taddStylesToDom(newStyles, options);\r\n\t\t\t}\r\n\t\t\tfor(var i = 0; i < mayRemove.length; i++) {\r\n\t\t\t\tvar domStyle = mayRemove[i];\r\n\t\t\t\tif(domStyle.refs === 0) {\r\n\t\t\t\t\tfor(var j = 0; j < domStyle.parts.length; j++)\r\n\t\t\t\t\t\tdomStyle.parts[j]();\r\n\t\t\t\t\tdelete stylesInDom[domStyle.id];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\t\r\n\tfunction addStylesToDom(styles, options) {\r\n\t\tfor(var i = 0; i < styles.length; i++) {\r\n\t\t\tvar item = styles[i];\r\n\t\t\tvar domStyle = stylesInDom[item.id];\r\n\t\t\tif(domStyle) {\r\n\t\t\t\tdomStyle.refs++;\r\n\t\t\t\tfor(var j = 0; j < domStyle.parts.length; j++) {\r\n\t\t\t\t\tdomStyle.parts[j](item.parts[j]);\r\n\t\t\t\t}\r\n\t\t\t\tfor(; j < item.parts.length; j++) {\r\n\t\t\t\t\tdomStyle.parts.push(addStyle(item.parts[j], options));\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tvar parts = [];\r\n\t\t\t\tfor(var j = 0; j < item.parts.length; j++) {\r\n\t\t\t\t\tparts.push(addStyle(item.parts[j], options));\r\n\t\t\t\t}\r\n\t\t\t\tstylesInDom[item.id] = {id: item.id, refs: 1, parts: parts};\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tfunction listToStyles(list) {\r\n\t\tvar styles = [];\r\n\t\tvar newStyles = {};\r\n\t\tfor(var i = 0; i < list.length; i++) {\r\n\t\t\tvar item = list[i];\r\n\t\t\tvar id = item[0];\r\n\t\t\tvar css = item[1];\r\n\t\t\tvar media = item[2];\r\n\t\t\tvar sourceMap = item[3];\r\n\t\t\tvar part = {css: css, media: media, sourceMap: sourceMap};\r\n\t\t\tif(!newStyles[id])\r\n\t\t\t\tstyles.push(newStyles[id] = {id: id, parts: [part]});\r\n\t\t\telse\r\n\t\t\t\tnewStyles[id].parts.push(part);\r\n\t\t}\r\n\t\treturn styles;\r\n\t}\r\n\t\r\n\tfunction insertStyleElement(options, styleElement) {\r\n\t\tvar head = getHeadElement();\r\n\t\tvar lastStyleElementInsertedAtTop = styleElementsInsertedAtTop[styleElementsInsertedAtTop.length - 1];\r\n\t\tif (options.insertAt === \"top\") {\r\n\t\t\tif(!lastStyleElementInsertedAtTop) {\r\n\t\t\t\thead.insertBefore(styleElement, head.firstChild);\r\n\t\t\t} else if(lastStyleElementInsertedAtTop.nextSibling) {\r\n\t\t\t\thead.insertBefore(styleElement, lastStyleElementInsertedAtTop.nextSibling);\r\n\t\t\t} else {\r\n\t\t\t\thead.appendChild(styleElement);\r\n\t\t\t}\r\n\t\t\tstyleElementsInsertedAtTop.push(styleElement);\r\n\t\t} else if (options.insertAt === \"bottom\") {\r\n\t\t\thead.appendChild(styleElement);\r\n\t\t} else {\r\n\t\t\tthrow new Error(\"Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.\");\r\n\t\t}\r\n\t}\r\n\t\r\n\tfunction removeStyleElement(styleElement) {\r\n\t\tstyleElement.parentNode.removeChild(styleElement);\r\n\t\tvar idx = styleElementsInsertedAtTop.indexOf(styleElement);\r\n\t\tif(idx >= 0) {\r\n\t\t\tstyleElementsInsertedAtTop.splice(idx, 1);\r\n\t\t}\r\n\t}\r\n\t\r\n\tfunction createStyleElement(options) {\r\n\t\tvar styleElement = document.createElement(\"style\");\r\n\t\tstyleElement.type = \"text/css\";\r\n\t\tinsertStyleElement(options, styleElement);\r\n\t\treturn styleElement;\r\n\t}\r\n\t\r\n\tfunction createLinkElement(options) {\r\n\t\tvar linkElement = document.createElement(\"link\");\r\n\t\tlinkElement.rel = \"stylesheet\";\r\n\t\tinsertStyleElement(options, linkElement);\r\n\t\treturn linkElement;\r\n\t}\r\n\t\r\n\tfunction addStyle(obj, options) {\r\n\t\tvar styleElement, update, remove;\r\n\t\r\n\t\tif (options.singleton) {\r\n\t\t\tvar styleIndex = singletonCounter++;\r\n\t\t\tstyleElement = singletonElement || (singletonElement = createStyleElement(options));\r\n\t\t\tupdate = applyToSingletonTag.bind(null, styleElement, styleIndex, false);\r\n\t\t\tremove = applyToSingletonTag.bind(null, styleElement, styleIndex, true);\r\n\t\t} else if(obj.sourceMap &&\r\n\t\t\ttypeof URL === \"function\" &&\r\n\t\t\ttypeof URL.createObjectURL === \"function\" &&\r\n\t\t\ttypeof URL.revokeObjectURL === \"function\" &&\r\n\t\t\ttypeof Blob === \"function\" &&\r\n\t\t\ttypeof btoa === \"function\") {\r\n\t\t\tstyleElement = createLinkElement(options);\r\n\t\t\tupdate = updateLink.bind(null, styleElement);\r\n\t\t\tremove = function() {\r\n\t\t\t\tremoveStyleElement(styleElement);\r\n\t\t\t\tif(styleElement.href)\r\n\t\t\t\t\tURL.revokeObjectURL(styleElement.href);\r\n\t\t\t};\r\n\t\t} else {\r\n\t\t\tstyleElement = createStyleElement(options);\r\n\t\t\tupdate = applyToTag.bind(null, styleElement);\r\n\t\t\tremove = function() {\r\n\t\t\t\tremoveStyleElement(styleElement);\r\n\t\t\t};\r\n\t\t}\r\n\t\r\n\t\tupdate(obj);\r\n\t\r\n\t\treturn function updateStyle(newObj) {\r\n\t\t\tif(newObj) {\r\n\t\t\t\tif(newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap)\r\n\t\t\t\t\treturn;\r\n\t\t\t\tupdate(obj = newObj);\r\n\t\t\t} else {\r\n\t\t\t\tremove();\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\t\r\n\tvar replaceText = (function () {\r\n\t\tvar textStore = [];\r\n\t\r\n\t\treturn function (index, replacement) {\r\n\t\t\ttextStore[index] = replacement;\r\n\t\t\treturn textStore.filter(Boolean).join('\\n');\r\n\t\t};\r\n\t})();\r\n\t\r\n\tfunction applyToSingletonTag(styleElement, index, remove, obj) {\r\n\t\tvar css = remove ? \"\" : obj.css;\r\n\t\r\n\t\tif (styleElement.styleSheet) {\r\n\t\t\tstyleElement.styleSheet.cssText = replaceText(index, css);\r\n\t\t} else {\r\n\t\t\tvar cssNode = document.createTextNode(css);\r\n\t\t\tvar childNodes = styleElement.childNodes;\r\n\t\t\tif (childNodes[index]) styleElement.removeChild(childNodes[index]);\r\n\t\t\tif (childNodes.length) {\r\n\t\t\t\tstyleElement.insertBefore(cssNode, childNodes[index]);\r\n\t\t\t} else {\r\n\t\t\t\tstyleElement.appendChild(cssNode);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\tfunction applyToTag(styleElement, obj) {\r\n\t\tvar css = obj.css;\r\n\t\tvar media = obj.media;\r\n\t\tvar sourceMap = obj.sourceMap;\r\n\t\r\n\t\tif(media) {\r\n\t\t\tstyleElement.setAttribute(\"media\", media)\r\n\t\t}\r\n\t\r\n\t\tif(styleElement.styleSheet) {\r\n\t\t\tstyleElement.styleSheet.cssText = css;\r\n\t\t} else {\r\n\t\t\twhile(styleElement.firstChild) {\r\n\t\t\t\tstyleElement.removeChild(styleElement.firstChild);\r\n\t\t\t}\r\n\t\t\tstyleElement.appendChild(document.createTextNode(css));\r\n\t\t}\r\n\t}\r\n\t\r\n\tfunction updateLink(linkElement, obj) {\r\n\t\tvar css = obj.css;\r\n\t\tvar media = obj.media;\r\n\t\tvar sourceMap = obj.sourceMap;\r\n\t\r\n\t\tif(sourceMap) {\r\n\t\t\t// http://stackoverflow.com/a/26603875\r\n\t\t\tcss += \"\\n/*# sourceMappingURL=data:application/json;base64,\" + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + \" */\";\r\n\t\t}\r\n\t\r\n\t\tvar blob = new Blob([css], { type: \"text/css\" });\r\n\t\r\n\t\tvar oldSrc = linkElement.href;\r\n\t\r\n\t\tlinkElement.href = URL.createObjectURL(blob);\r\n\t\r\n\t\tif(oldSrc)\r\n\t\t\tURL.revokeObjectURL(oldSrc);\r\n\t}\r\n\n\n/***/ }\n/******/ ])\n});\n;\n\n\n/** WEBPACK FOOTER **\n ** sf.crop.min.js\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap e0c597d8fa25c1088802\n **/","\"use strict\";\r\nimport sf from 'sf';//resolved in webpack's \"externals\"\r\nimport Crop from './crop';\r\n\r\nrequire(\"style!css?minimize!less!./crop.less\");\r\n\r\nsf.instancesController.registerInstanceType(Crop,\"js-sf-cropper\");\r\nmodule.exports = Crop;   // ES6 default export will not expose us as global\n\n\n/** WEBPACK FOOTER **\n ** d:/OpenServer/domains/spiral-modules/cropper/src/index.js\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_1__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"sf\"\n ** module id = 1\n ** module chunks = 0 1\n **/","\"use strict\";\r\n\r\nimport sf from 'sf';//resolved in webpack's \"externals\"\r\n\r\nvar externals = {\r\n    template: require(\"html!./template.html\")\r\n};\r\nvar Crop = function (sf, node, options) {\r\n    this._construct(sf, node, options);\r\n};\r\n\r\n/**\r\n * @lends sf.Form.prototype\r\n */\r\nCrop.prototype = Object.create(sf.modules.core.BaseDOMConstructor.prototype);\r\n\r\n/**\r\n * Name to register\r\n * @type {string}\r\n */\r\nCrop.prototype.name = \"crop\";\r\n\r\nCrop.prototype._construct = function (sf, node, options) {\r\n\r\n    this.init(sf, node, options);//call parent\r\n\r\n    this.options.template = this.options.template || externals.template;\r\n\r\n    var that = this,\r\n        noop = function () {\r\n        },\r\n        parser = new DOMParser();\r\n\r\n    if (options) {//if we pass options extend all options by passed options\r\n        this.options = sf.tools.extend(this.options, options);\r\n    }\r\n\r\n    if (typeof this.options.info == \"string\")\r\n        this.options.info = this.options.info.split(\",\");\r\n\r\n    if (this.options.ratio)\r\n        this.options.ratio = parseFloat(this.options.ratio);//just to be sure about number format, not string\r\n    if (typeof this.options.onFileProcessed != \"function\")\r\n        this.options.onFileProcessed = noop;\r\n\r\n    //elements\r\n    this.els = {\r\n        node: node,\r\n        input: node.tagName === \"INPUT\" ? node : node.getElementsByClassName(\"sf-crop-input\")[0],\r\n        modal: parser.parseFromString(this.options.template, \"text/html\").firstChild.lastChild.firstChild\r\n    };\r\n\r\n    if (this.options.preview) {this.els.preview = document.querySelector(this.options.preview);} else {\r\n        console.warn('Cropper: no preview provided');\r\n    }\r\n\r\n    if (!this.options.ajaximage && !this.els.input) {\r\n        console.warn('Provide file-input to use cropper or load image with ajax (with data-ajaximage attr)');\r\n    }\r\n    this.els.cropWrapper = this.els.modal.getElementsByClassName(\"sf-crop-wrapper\")[0];\r\n    this.els.imageOriginal = this.els.modal.getElementsByClassName(\"sf-crop-image-original\")[0];\r\n    this.els.cropElements = this.els.modal.getElementsByClassName(\"sf-crop-elements\")[0];\r\n    this.els.cropSave = this.els.modal.getElementsByClassName(\"sf-crop-save\")[0];\r\n    this.els.closePopup = this.els.modal.getElementsByClassName(\"sf-crop-close\")[0];\r\n\r\n    this.els.cropInfo = {\r\n        ratio: this.els.modal.getElementsByClassName(\"sf-crop-ratio\")[0],\r\n        croppedSize: this.els.modal.getElementsByClassName(\"sf-crop-cropped-size\")[0],\r\n        origSize: this.els.modal.getElementsByClassName(\"sf-crop-orig-size\")[0]\r\n    };\r\n\r\n    this.els.handlers = {\r\n        n: this.els.modal.getElementsByClassName(\"handler-N\")[0],\r\n        ne: this.els.modal.getElementsByClassName(\"handler-NE\")[0],\r\n        e: this.els.modal.getElementsByClassName(\"handler-E\")[0],\r\n        se: this.els.modal.getElementsByClassName(\"handler-SE\")[0],\r\n        s: this.els.modal.getElementsByClassName(\"handler-S\")[0],\r\n        sw: this.els.modal.getElementsByClassName(\"handler-SW\")[0],\r\n        w: this.els.modal.getElementsByClassName(\"handler-W\")[0],\r\n        nw: this.els.modal.getElementsByClassName(\"handler-NW\")[0],\r\n        current: null\r\n    };\r\n\r\n    this.els.dimmers = {\r\n        el: this.els.modal.getElementsByClassName(\"dimmers\")[0],\r\n        n: this.els.modal.getElementsByClassName(\"dimmer-N\")[0],\r\n        e: this.els.modal.getElementsByClassName(\"dimmer-E\")[0],\r\n        s: this.els.modal.getElementsByClassName(\"dimmer-S\")[0],\r\n        w: this.els.modal.getElementsByClassName(\"dimmer-W\")[0]\r\n    };\r\n\r\n    this.els.form = this.els.input ? this.els.input.form : '';\r\n    this.form = sf.instancesController.getInstance(\"form\", this.els.form);\r\n\r\n    this.reset();\r\n    this.addEventListeners();\r\n    this.attachData();\r\n\r\n    if (this.options.ajaximage) {\r\n        if (this.els.input && this.els.input !== this.els.node) this.els.input.parentNode.removeChild(this.els.input); //this check is for not to remove cropper's node and not to trigger die method\r\n        var xhr = new XMLHttpRequest();\r\n        xhr.onreadystatechange = function () {\r\n            if (this.readyState == 4 && this.status == 200) {\r\n                var img = new Image();\r\n                var url = window.URL || window.webkitURL;\r\n                if (this.response instanceof Blob) {\r\n                    img.src = url.createObjectURL(this.response);\r\n                    that.handleFileSelect(this.response);\r\n                    //that.els.adjust.style.display = 'inline-block';\r\n                } else {\r\n                    that.els.adjust.parentNode.removeChild(that.els.adjust);\r\n                }\r\n            }\r\n        };\r\n        xhr.open('GET', that.options.ajaximage);\r\n        xhr.responseType = 'blob';\r\n        xhr.send();\r\n    }\r\n    //IE10 click to move doesn't work. looks like click goes through cropper to background picture =(\r\n    if (navigator.appVersion.indexOf(\"MSIE 10\") != -1)\r\n        this.els.cropElements.style.backgroundColor = \"rgba(255,255,255,0.01\";\r\n};\r\n\r\n\r\n/**\r\n * @override\r\n * @inheritDoc\r\n * @enum {string}\r\n */\r\nCrop.prototype.optionsToGrab  = {\r\n    /**\r\n     *  How to send: cropped or full size with coordinates to crop on server <b>Default: \"cropped\"</b> <i>Optional: \"full\"</i>\r\n     */\r\n    \"format\": {\r\n        \"value\": \"cropped\",\r\n        \"domAttr\": \"data-format\"\r\n    },\r\n    /**\r\n     *  Preloading of image  <b>Default: \"false\"</b> <i>Optional: url of image to preload</i>\r\n     */\r\n    \"ajaximage\": {\r\n        \"value\": false,\r\n        \"domAttr\": \"data-ajaximage\"\r\n    },\r\n    \"template\": {\r\n        \"domAttr\": \"data-template\"\r\n    },\r\n    /**\r\n     *  Request address for submitting (if there is no form) <b>Default: \"false\"</b> <i>Optional: request URL</i>\r\n     */\r\n    \"ajaxAddress\": {\r\n        \"value\": false,\r\n        \"domAttr\": \"data-ajaxAddress\"\r\n    },\r\n    /**\r\n     *  Locked aspect ratio <b>Default: false</b>\r\n     */\r\n    \"ratio\": {\r\n        \"value\": false,\r\n        \"domAttr\": \"data-ratio\"\r\n    },\r\n    /**\r\n     *  What info to show <b>Default: []</b></br>\r\n     *  <b>Example: </b>data-info=\"ratio,origSize,croppedSize\"</br>\r\n     *  <b>Note: </b>done only ratio\r\n     */\r\n    \"info\": {\r\n        \"value\": [],\r\n        \"domAttr\": \"data-info\"\r\n    },\r\n    /**\r\n     *  ID of preview element <b>Default: \"\"</b>\r\n     */\r\n    \"preview\": {\r\n        \"value\": \"\",\r\n        \"domAttr\": \"data-preview\"\r\n    },\r\n    /**\r\n     *  Selector of element which twiggers crop-modal <b>Default: \"\"</b>\r\n     */\r\n    \"adjust\": {\r\n        \"value\": \"\",\r\n        \"domAttr\": \"data-adjust\"\r\n    },\r\n    /**\r\n     *  Name for formData <b>Default: \"cropped\"</b>\r\n     */\r\n    \"name\": {\r\n        \"value\": \"cropped\",\r\n        \"domAttr\": \"data-name\"\r\n    }\r\n};\r\nCrop.prototype.reset = function () {\r\n    //Coordinates and Variables\r\n    this.cnv = {\r\n        cursor: {x: 0, y: 0},\r\n        crop: {x: 0, y: 0, x2: 0, y2: 0, w: 0, h: 0},\r\n        toSave: {x: 0, y: 0, w: 0, h: 0},\r\n        image: {w: 0, h: 0},\r\n        old: {\r\n            cursor: {x: 0, y: 0}\r\n        },\r\n        start: {\r\n            crop: {x: 0, y: 0, w: 0, h: 0}\r\n        },\r\n        canvas: {w: 538, h: 0},\r\n        orig: {},\r\n        preview: {w: 0, h: 0},\r\n        scale: 1\r\n    };\r\n    this.setTop(0);\r\n    this.setLeft(0);\r\n    this.setWidth(0);\r\n    this.setHeight(0);\r\n\r\n    if (this.els.imageOriginal.lastChild)\r\n        this.els.imageOriginal.removeChild(this.els.imageOriginal.lastChild);\r\n};\r\n/**\r\n * Changes crop info if need.\r\n * @param type {string}\r\n * @param value {string|number}\r\n */\r\nCrop.prototype.changeInfo = function (type, value) {\r\n    switch (type) {\r\n        case \"ratio\":\r\n            this.els.cropInfo.ratio.innerHTML = \"Aspect ratio: \" + value;\r\n            break;\r\n        case \"croppedSize\":\r\n            this.els.cropInfo.croppedSize.innerHTML = \"Cropped size: \" + value[0]+'x'+value[1];\r\n            break;\r\n        case \"origSize\":\r\n            this.els.cropInfo.origSize.innerHTML = \"Original size: \" + value[0]+'x'+value[1];\r\n            break;\r\n        default:\r\n            break;\r\n    }\r\n};\r\n/**\r\n * Update cropping info.\r\n */\r\nCrop.prototype.updateInfo = function () {\r\n    var that = this;\r\n    if (this.options.info.length > 0) {\r\n        this.options.info.forEach(function (info) {\r\n            if (info == \"ratio\")\r\n                that.changeInfo(\"ratio\", Math.round(that.cnv.crop.w / that.cnv.crop.h * 100) / 100);\r\n            if (info == \"croppedSize\")\r\n                that.changeInfo(\"croppedSize\", [Math.round(that.cnv.crop.w * that.cnv.scale), Math.round(that.cnv.crop.h * that.cnv.scale)]);\r\n        });\r\n    }\r\n};\r\n/**\r\n * Shows modal with cropper\r\n */\r\nCrop.prototype.showPopup = function () {\r\n    document.body.appendChild(this.els.modal);\r\n    this.addModalEventListeners();\r\n    this.removeEventListeners();\r\n};\r\n/**\r\n * Hides modal with cropper\r\n */\r\nCrop.prototype.hidePopup = function () {\r\n    this.els.modal.parentNode.removeChild(this.els.modal);\r\n    this.removeModalEventListeners();\r\n    this.addEventListeners();\r\n};\r\n\r\n/**\r\n * Adds static events listeners.\r\n */\r\nCrop.prototype.addEventListeners = function () {\r\n    var that = this;\r\n\r\n    this._inputChange = function(e){\r\n        //IE9 doesn't support File API\r\n        var file = e.target.files[0];\r\n        if (!file.type.match(/image/)) {\r\n            alert(\"Please select an image.\");\r\n            return;\r\n        }\r\n        that.handleFileSelect(file);\r\n        if (that.els.adjust) that.els.adjust.style.display = 'inline-block';\r\n    };\r\n\r\n    this._openCropper = function (e) {\r\n        if (that.img) {\r\n            if (that.readyToPrepare)\r\n                that.prepare();\r\n            that.showPopup();\r\n        }\r\n    };\r\n\r\n    if (this.els.input) {\r\n        this.els.input.addEventListener('change', this._inputChange);\r\n    }\r\n    if (this.els.preview) {\r\n        this.els.preview.addEventListener('click', this._openCropper);\r\n    }\r\n    if (this.els.adjust) {\r\n        this.els.adjust.addEventListener('click', this._openCropper);\r\n    }\r\n};\r\n\r\nCrop.prototype.removeEventListeners = function () {\r\n    if (this.els.input) {\r\n        this.els.input.removeEventListener('change', this._inputChange);\r\n    }\r\n    if (this.els.preview) {\r\n        this.els.preview.removeEventListener('click', this._openCropper);\r\n    }\r\n    if (this.els.adjust) {\r\n        this.els.adjust.removeEventListener('click', this._openCropper);\r\n    }\r\n};\r\n\r\n/**\r\n * Adds events listeners for modal.\r\n */\r\nCrop.prototype.addModalEventListeners = function () {\r\n    var that = this;\r\n\r\n    this._cropSave = function(){\r\n        that.save();\r\n        that.hidePopup();\r\n    };\r\n\r\n    this._hidePopup = function(){ //this fn to save correct \"this\" and to be able to remove listener later\r\n        that.hidePopup();\r\n    };\r\n\r\n    this._cropWrapperMouseDown = function(e){\r\n        that.onCropStart(e);\r\n        that.inCropping = true;\r\n    };\r\n\r\n    this._documentMouseMove = function(e){\r\n        if (that.inCropping) {\r\n            e.preventDefault(); //prevent selecting background elements\r\n            that.onCrop(e);\r\n        }\r\n    };\r\n\r\n    this._cropWrapperMouseUp = function(){\r\n        that.onCropEnd();\r\n        that.inCropping = false;\r\n    };\r\n\r\n    this._documentMouseUp = function(){\r\n        that.onCropEnd();\r\n        that.inCropping = false;\r\n    };\r\n    this.els.closePopup.addEventListener(\"click\", this._hidePopup);\r\n    this.els.cropSave.addEventListener(\"click\", this._cropSave);\r\n    this.els.cropWrapper.addEventListener(\"mousedown\", this._cropWrapperMouseDown);\r\n    this.els.cropWrapper.addEventListener(\"mouseup\", this._cropWrapperMouseUp);\r\n    document.addEventListener(\"mousemove\", this._documentMouseMove);\r\n    document.addEventListener(\"mouseup\", this._documentMouseUp);\r\n};\r\n\r\nCrop.prototype.removeModalEventListeners = function () {\r\n    this.els.closePopup.removeEventListener(\"click\", this._hidePopup);\r\n    this.els.cropSave.removeEventListener(\"click\", this._cropSave);\r\n    this.els.cropWrapper.removeEventListener(\"mousedown\", this._cropWrapperMouseDown);\r\n    this.els.cropWrapper.removeEventListener(\"mouseup\", this._cropWrapperMouseUp);\r\n    document.removeEventListener(\"mousemove\", this._documentMouseMove);\r\n    document.removeEventListener(\"mouseup\", this._documentMouseUp);\r\n};\r\n\r\n/**\r\n * Sets preview\r\n * @param img\r\n */\r\nCrop.prototype.setPreviewImage = function (img) {\r\n    var that = this;\r\n    if (that.els.preview) {\r\n//        if (that.els.preview.lastChild) // Don't remember why was removing only last child\r\n//            that.els.preview.removeChild(that.els.preview.lastChild);\r\n        while (that.els.preview.firstChild) {\r\n            that.els.preview.removeChild(that.els.preview.firstChild);\r\n        }\r\n        var newimg = img.cloneNode(true);\r\n        newimg.style.maxWidth = \"100%\";\r\n        that.els.preview.appendChild(newimg);\r\n    }\r\n\r\n};\r\n/**\r\n * Reads file, selected by user\r\n * @param file\r\n */\r\nCrop.prototype.handleFileSelect = function (file) {\r\n    var that = this;\r\n    this.reader = new FileReader();\r\n    this.reset();\r\n    this.reader.onload = (function (theFile) {\r\n        return function (e) {\r\n            that.file = {\r\n                file: theFile,\r\n                blob: theFile,\r\n                name: encodeURIComponent(theFile.name ? theFile.name : that.options.ajaximage.replace(/^.*[\\\\\\/]/, '')),\r\n                base64: e.target.result\r\n            };\r\n            that.img = new Image();\r\n            that.img.src = that.file.base64;\r\n            that.img.onload = function () {\r\n                that.setPreviewImage(that.img);\r\n                that.cnv.preview.h = that.img.clientHeight;\r\n                that.cnv.preview.w = that.img.clientWidth;\r\n                that.cnv.orig.h = that.img.naturalHeight;\r\n                that.cnv.orig.w = that.img.naturalWidth;\r\n                that.cnv.orig.ratio = that.cnv.orig.w / that.cnv.orig.h;\r\n                if (that.cnv.orig.ratio < 1)  that.cnv.canvas.w *=  that.cnv.orig.ratio; // if image is too narrow -> correct canvas sizes not to exceed display sizes\r\n                that.cnv.scale = that.cnv.orig.w / that.cnv.canvas.w;\r\n                that.cnv.toSave.w = that.cnv.orig.w;\r\n                that.cnv.toSave.h = that.cnv.orig.h;\r\n\r\n\r\n                if (that.els.imageOriginal.lastChild)\r\n                    that.els.imageOriginal.removeChild(that.els.imageOriginal.lastChild);\r\n                that.readyToPrepare = true;\r\n                that.options.onFileProcessed();\r\n            };\r\n\r\n        };\r\n    })(file);\r\n\r\n    this.reader.readAsDataURL(file);\r\n};\r\n\r\n/**\r\n * Prepares canvas, calculates coordinates\r\n */\r\nCrop.prototype.prepare = function () {\r\n    var that = this;\r\n    var c = document.createElement(\"canvas\");\r\n    c.width = that.cnv.canvas.w;\r\n    c.height = that.cnv.canvas.w / that.cnv.orig.ratio;\r\n    var ctx = c.getContext(\"2d\");\r\n\r\n    function drawImageOnCanvas() {//fix to NS_ERROR_NOT_AVAILABLE in firefox with ctx.drawImage\r\n        try {\r\n            ctx.drawImage(that.img, 0, 0, that.cnv.canvas.w, that.cnv.canvas.w / that.cnv.orig.ratio);\r\n        } catch (e) {\r\n            if (e.name == \"NS_ERROR_NOT_AVAILABLE\") {\r\n                setTimeout(drawImageOnCanvas, 0);\r\n            } else {\r\n                throw e;\r\n            }\r\n        }\r\n    }\r\n\r\n    drawImageOnCanvas();\r\n    that.els.imageOriginal.appendChild(c);\r\n    setTimeout(function () {\r\n        that.cnv.image.w = that.els.imageOriginal.lastChild.clientWidth;\r\n        that.cnv.image.h = that.els.imageOriginal.lastChild.clientHeight;\r\n        that.cnv.start.crop.w = that.cnv.image.w;\r\n        that.cnv.start.crop.h = that.cnv.image.h;\r\n        that.setWidth(that.cnv.image.w);\r\n        that.setHeight(that.cnv.image.h);\r\n        that.cnv.crop.x2 = that.cnv.image.w;\r\n        that.cnv.crop.y2 = that.cnv.image.h;\r\n\r\n        if (that.options.ratio) {\r\n            if (that.cnv.orig.ratio > that.options.ratio) {\r\n                var w = that.cnv.crop.w;\r\n                that.setWidth(Math.round(that.cnv.start.crop.h * that.options.ratio));\r\n                that.cnv.start.crop.w = that.cnv.crop.w;\r\n                that.setLeft(Math.round((w - that.cnv.crop.w) / 2));\r\n                that.cnv.crop.x2 = that.cnv.crop.x + that.cnv.crop.w;\r\n            } else {\r\n                var h = that.cnv.crop.h;\r\n                that.setHeight(Math.round(that.cnv.start.crop.w / that.options.ratio));\r\n                that.cnv.start.crop.h = that.cnv.crop.h;\r\n                that.setTop(Math.round((h - that.cnv.crop.h) / 2));\r\n                that.cnv.crop.y2 = that.cnv.crop.y + that.cnv.crop.h;\r\n            }\r\n\r\n            that.save();\r\n        }\r\n        that.updateInfo();\r\n        if (that.options.info.indexOf(\"origSize\") > -1) {\r\n            that.changeInfo(\"origSize\", [that.cnv.orig.w, that.cnv.orig.h]); //no need to pass through updateInfo since it's static\r\n        }\r\n\r\n        that.readyToPrepare = false;\r\n    }, 50);\r\n};\r\n\r\n/**\r\n * Processes crop start.\r\n * @param {Event} e\r\n */\r\nCrop.prototype.onCropStart = function (e) {\r\n    this.els.handlers.current = e.target;\r\n    this.cnv.offset = this.els.cropWrapper.getBoundingClientRect();\r\n    this.cnv.cursor.x = Math.round(e.clientX - this.cnv.offset.left);\r\n    this.cnv.cursor.y = Math.round(e.clientY - this.cnv.offset.top);\r\n    this.cnv.cursor.offsetX = e.offsetX === undefined ? Math.round(e.layerX) : Math.round(e.offsetX);\r\n    this.cnv.cursor.offsetY = e.offsetY === undefined ? Math.round(e.layerY) : Math.round(e.offsetY);\r\n};\r\n\r\n/**\r\n * Processes cropping (mouse move)\r\n * @param  {Event} e\r\n */\r\nCrop.prototype.onCrop = function (e) {\r\n    if (!this.els.handlers.current) return;\r\n    this.cnv.cursor.x = Math.round(e.clientX - this.cnv.offset.left);\r\n    this.cnv.cursor.y = Math.round(e.clientY - this.cnv.offset.top);\r\n    switch (this.els.handlers.current) {\r\n        case this.els.handlers.n:\r\n            this.setN();\r\n            break;\r\n        case this.els.handlers.ne:\r\n            this.setNE();\r\n            break;\r\n        case this.els.handlers.e:\r\n            this.setE();\r\n            break;\r\n        case this.els.handlers.se:\r\n            this.setSE();\r\n            break;\r\n        case this.els.handlers.s:\r\n            this.setS();\r\n            break;\r\n        case this.els.handlers.sw:\r\n            this.setSW();\r\n            break;\r\n        case this.els.handlers.w:\r\n            this.setW();\r\n            break;\r\n        case this.els.handlers.nw:\r\n            this.setNW();\r\n            break;\r\n        case this.els.cropElements:\r\n            this.move();\r\n            break;\r\n    }\r\n    this.updateInfo();\r\n};\r\n\r\n/**\r\n * Process crop end.\r\n */\r\nCrop.prototype.onCropEnd = function () {\r\n    this.els.handlers.current = null;\r\n};\r\n/**\r\n * Sets left side of cropper\r\n * @param x {number}\r\n */\r\nCrop.prototype.setLeft = function (x) {\r\n    this.cnv.crop.x = x;\r\n    this.els.cropElements.style.left = x + \"px\";\r\n    this.els.dimmers.el.style.left = x + \"px\";\r\n};\r\n/**\r\n * Sets top side of cropper\r\n * @param y {number}\r\n */\r\nCrop.prototype.setTop = function (y) {\r\n    this.cnv.crop.y = y;\r\n    this.els.cropElements.style.top = y + \"px\";\r\n    this.els.dimmers.el.style.top = y + \"px\";\r\n};\r\n/**\r\n * Sets width of cropper\r\n * @param w {number}\r\n */\r\nCrop.prototype.setWidth = function (w) {\r\n    this.cnv.crop.w = w;\r\n    this.els.cropElements.style.width = w + \"px\";\r\n    this.els.dimmers.el.style.width = w + \"px\";\r\n};\r\n/**\r\n * Sets height of cropper\r\n * @param h {number}\r\n */\r\nCrop.prototype.setHeight = function (h) {\r\n    this.cnv.crop.h = h;\r\n    this.els.cropElements.style.height = h + \"px\";\r\n    this.els.dimmers.el.style.height = h + \"px\";\r\n};\r\n\r\n/**\r\n * Adjusts coordinates.\r\n * @param {boolean|undefined} notDefaultSide\r\n * @param {number} y\r\n */\r\nCrop.prototype.adjustN = function (notDefaultSide, y) {\r\n    if (notDefaultSide) {\r\n        if ((this.cnv.crop.y2 - y) * this.options.ratio <= this.cnv.crop.x2) {\r\n            this.setTop(y);\r\n            this.setHeight(this.cnv.crop.y2 - y);\r\n            this.setWidth(Math.round(this.cnv.crop.h * this.options.ratio));\r\n            this.setLeft(this.cnv.crop.x2 - this.cnv.crop.w);\r\n        } else {\r\n            this.setLeft(0);\r\n            this.setWidth(this.cnv.crop.x2);\r\n            this.setTop(this.cnv.crop.y2 - Math.round(this.cnv.crop.w / this.options.ratio));\r\n        }\r\n    } else {\r\n        if ((this.cnv.crop.y2 - y) * this.options.ratio + this.cnv.crop.x <= this.cnv.image.w) {\r\n            this.setTop(y);\r\n            this.setHeight(this.cnv.crop.y2 - y);\r\n            this.setWidth(Math.round(this.cnv.crop.h * this.options.ratio));\r\n            this.cnv.crop.x2 = this.cnv.crop.x + this.cnv.crop.w;\r\n        } else {\r\n            this.setWidth(this.cnv.image.w - this.cnv.crop.x);\r\n            this.setTop(this.cnv.crop.y2 - Math.round(this.cnv.crop.w / this.options.ratio));\r\n            this.setHeight(this.cnv.crop.y2 - this.cnv.crop.y);\r\n            this.cnv.crop.x2 = this.cnv.image.w;\r\n        }\r\n    }\r\n};\r\n\r\n/**\r\n * Sets top coordinates and border.\r\n * @param {Boolean} [notDefaultSide]\r\n */\r\nCrop.prototype.setN = function (notDefaultSide) {\r\n    if (this.options.ratio) {\r\n        if (this.cnv.cursor.y > 0) {\r\n            if (this.cnv.cursor.y < this.cnv.crop.y2) {\r\n                this.adjustN(notDefaultSide, this.cnv.cursor.y);\r\n            } else {\r\n                this.setHeight(1);\r\n                this.setWidth(Math.round(this.cnv.crop.h * this.options.ratio));\r\n                if (notDefaultSide) {\r\n                    this.setLeft(this.cnv.crop.x2 - 1);\r\n                } else {\r\n                    this.cnv.crop.x2 = this.cnv.crop.x + this.cnv.crop.w;\r\n                }\r\n                this.setTop(this.cnv.crop.y2 - 1);\r\n            }\r\n        } else {\r\n            this.adjustN(notDefaultSide, 0);\r\n        }\r\n    } else {\r\n        if (this.cnv.cursor.y > 0) {\r\n            if (this.cnv.cursor.y < this.cnv.crop.y2) {\r\n                this.setTop(this.cnv.cursor.y);\r\n                this.setHeight(this.cnv.crop.y2 - this.cnv.crop.y);\r\n            } else {\r\n                this.setTop(this.cnv.crop.y2 - 1);\r\n                this.setHeight(1);\r\n            }\r\n        } else {\r\n            this.setTop(0);\r\n            this.setHeight(this.cnv.crop.y2);\r\n        }\r\n    }\r\n};\r\n\r\n/**\r\n * Adjusts coordinates.\r\n * @param {boolean|undefined} notDefaultSide\r\n * @param {number} y2\r\n */\r\nCrop.prototype.adjustS = function (notDefaultSide, y2) {\r\n    if (notDefaultSide) {\r\n        if ((y2 - this.cnv.crop.y) * this.options.ratio <= this.cnv.crop.x2) {\r\n            this.setHeight(y2 - this.cnv.crop.y);\r\n            this.setWidth(Math.round(this.cnv.crop.h * this.options.ratio));\r\n            this.setLeft(this.cnv.crop.x2 - this.cnv.crop.w);\r\n            this.cnv.crop.y2 = y2;\r\n        } else {\r\n            this.setLeft(0);\r\n            this.setWidth(this.cnv.crop.x2);\r\n            this.setHeight(Math.round(this.cnv.crop.w / this.options.ratio));\r\n            this.cnv.crop.y2 = this.cnv.crop.y + this.cnv.crop.h;\r\n        }\r\n    } else {\r\n        if ((y2 - this.cnv.crop.y) * this.options.ratio + this.cnv.crop.x <= this.cnv.image.w) {\r\n            this.setHeight(y2 - this.cnv.crop.y);\r\n            this.setWidth(Math.round(this.cnv.crop.h * this.options.ratio));\r\n            this.cnv.crop.y2 = y2;\r\n            this.cnv.crop.x2 = this.cnv.crop.x + this.cnv.crop.w;\r\n        } else {\r\n            this.setWidth(this.cnv.image.w - this.cnv.crop.x);\r\n            this.setHeight(Math.round(this.cnv.crop.w / this.options.ratio));\r\n            this.cnv.crop.x2 = this.cnv.image.w;\r\n            this.cnv.crop.y2 = this.cnv.crop.y + this.cnv.crop.h;\r\n        }\r\n    }\r\n};\r\n\r\n/**\r\n * Sets bottom coordinates and border.\r\n * @param {Boolean} [notDefaultSide]\r\n */\r\nCrop.prototype.setS = function (notDefaultSide) {\r\n    if (this.options.ratio) {\r\n        if (this.cnv.cursor.y < this.cnv.image.h) {\r\n            if (this.cnv.cursor.y > this.cnv.crop.y) {\r\n                this.adjustS(notDefaultSide, this.cnv.cursor.y);\r\n            } else {\r\n                this.setHeight(1);\r\n                this.setWidth(Math.round(this.cnv.crop.h * this.options.ratio));\r\n                if (notDefaultSide) {\r\n                    this.setLeft(this.cnv.crop.x2 - 1);\r\n                } else {\r\n                    this.cnv.crop.x2 = this.cnv.crop.x + this.cnv.crop.w;\r\n                }\r\n                this.cnv.crop.y2 = this.cnv.crop.y + 1;\r\n            }\r\n        } else {\r\n            this.adjustS(notDefaultSide, this.cnv.image.h);\r\n        }\r\n    } else {\r\n        if (this.cnv.cursor.y < this.cnv.image.h) {\r\n            if (this.cnv.cursor.y > this.cnv.crop.y) {\r\n                this.setHeight(this.cnv.cursor.y - this.cnv.crop.y);\r\n                this.cnv.crop.y2 = this.cnv.cursor.y;\r\n            } else {\r\n                this.setHeight(1);\r\n                this.cnv.crop.y2 = this.cnv.crop.y + 1;\r\n            }\r\n        } else {\r\n            this.setHeight(this.cnv.image.h - this.cnv.crop.y);\r\n            this.cnv.crop.y2 = this.cnv.image.h;\r\n        }\r\n    }\r\n};\r\n\r\n/**\r\n * Adjusts coordinates.\r\n * @param {boolean|undefined} notDefaultSide\r\n * @param {number} x\r\n */\r\nCrop.prototype.adjustW = function (notDefaultSide, x) {\r\n    if (notDefaultSide) {\r\n        if (this.cnv.crop.y2 - (this.cnv.crop.x2 - x) / this.options.ratio >= 0) {\r\n            this.setLeft(x);\r\n            this.setWidth(this.cnv.crop.x2 - x);\r\n            this.setHeight(Math.round(this.cnv.crop.w / this.options.ratio));\r\n            this.setTop(this.cnv.crop.y2 - this.cnv.crop.h);\r\n        } else {\r\n            this.setTop(0);\r\n            this.setHeight(this.cnv.crop.y2);\r\n            this.setWidth(Math.round(this.cnv.crop.h * this.options.ratio));\r\n            this.setLeft(this.cnv.crop.x2 - this.cnv.crop.w);\r\n        }\r\n    } else {\r\n        if ((this.cnv.crop.x2 - x) / this.options.ratio + this.cnv.crop.y <= this.cnv.image.h) {\r\n            this.setLeft(x);\r\n            this.setWidth(this.cnv.crop.x2 - x);\r\n            this.setHeight(Math.round(this.cnv.crop.w / this.options.ratio));\r\n            this.cnv.crop.y2 = this.cnv.crop.y + this.cnv.crop.h;\r\n        } else {\r\n            this.setHeight(this.cnv.image.h - this.cnv.crop.y);\r\n            this.setWidth(Math.round(this.cnv.crop.h * this.options.ratio));\r\n            this.setLeft(this.cnv.crop.x2 - this.cnv.crop.w);\r\n            this.cnv.crop.y2 = this.cnv.image.h;\r\n        }\r\n    }\r\n};\r\n\r\n/**\r\n * Sets left coordinates and border.\r\n * @param {Boolean} [notDefaultSide]\r\n */\r\nCrop.prototype.setW = function (notDefaultSide) {\r\n    if (this.options.ratio) {\r\n        if (this.cnv.cursor.x > 0) {\r\n            if (this.cnv.cursor.x < this.cnv.crop.x2) {\r\n                this.adjustW(notDefaultSide, this.cnv.cursor.x);\r\n            } else {\r\n                this.setWidth(1);\r\n                this.setHeight(Math.round(this.cnv.crop.w / this.options.ratio));\r\n                if (notDefaultSide) {\r\n                    this.setTop(this.cnv.crop.y2 - 1);\r\n                } else {\r\n                    this.cnv.crop.y2 = this.cnv.crop.y + this.cnv.crop.h;\r\n                }\r\n            }\r\n        } else {\r\n            this.adjustW(notDefaultSide, 0);\r\n        }\r\n    } else {\r\n        if (this.cnv.cursor.x > 0) {\r\n            if (this.cnv.cursor.x < this.cnv.crop.x2) {\r\n                this.setLeft(this.cnv.cursor.x);\r\n                this.setWidth(this.cnv.crop.x2 - this.cnv.crop.x);\r\n            } else {\r\n                this.setLeft(this.cnv.crop.x2 - 1);\r\n                this.setWidth(1);\r\n            }\r\n        } else {\r\n            this.setLeft(0);\r\n            this.setWidth(this.cnv.crop.x2);\r\n        }\r\n    }\r\n};\r\n\r\n/**\r\n * Adjusts coordinates.\r\n * @param {boolean|undefined} notDefaultSide\r\n * @param {number} x\r\n */\r\nCrop.prototype.adjustE = function (notDefaultSide, x) {\r\n    if (notDefaultSide) {\r\n        if (this.cnv.crop.y2 - (x - this.cnv.crop.x) / this.options.ratio >= 0) {\r\n            this.setWidth(x - this.cnv.crop.x);\r\n            this.setHeight(Math.round(this.cnv.crop.w / this.options.ratio));\r\n            this.setTop(this.cnv.crop.y2 - this.cnv.crop.h);\r\n            this.cnv.crop.x2 = x;\r\n        } else {\r\n            this.setTop(0);\r\n            this.setHeight(this.cnv.crop.y2);\r\n            this.setWidth(Math.round(this.cnv.crop.h * this.options.ratio));\r\n            this.cnv.crop.x2 = this.cnv.crop.x + this.cnv.crop.w;\r\n        }\r\n    } else {\r\n        if ((x - this.cnv.crop.x) / this.options.ratio + this.cnv.crop.y <= this.cnv.image.h) {\r\n            this.setWidth(x - this.cnv.crop.x);\r\n            this.setHeight(Math.round(this.cnv.crop.w / this.options.ratio));\r\n            this.cnv.crop.x2 = x;\r\n            this.cnv.crop.y2 = this.cnv.crop.y + this.cnv.crop.h;\r\n        } else {\r\n            this.setHeight(this.cnv.image.h - this.cnv.crop.y);\r\n            this.setWidth(Math.round(this.cnv.crop.h * this.options.ratio));\r\n            this.cnv.crop.y2 = this.cnv.image.h;\r\n            this.cnv.crop.x2 = this.cnv.crop.x + this.cnv.crop.w;\r\n        }\r\n    }\r\n};\r\n\r\n/**\r\n * Sets right coordinates and border.\r\n * @param {Boolean} [notDefaultSide]\r\n */\r\nCrop.prototype.setE = function (notDefaultSide) {\r\n    if (this.options.ratio) {\r\n        if (this.cnv.cursor.x < this.cnv.image.w) {\r\n            if (this.cnv.cursor.x > this.cnv.crop.x) {\r\n                this.adjustE(notDefaultSide, this.cnv.cursor.x);\r\n            } else {\r\n                this.setWidth(1);\r\n                this.setHeight(Math.round(this.cnv.crop.w / this.options.ratio));\r\n                if (notDefaultSide) {\r\n                    this.setTop(this.cnv.crop.y2 - 1);\r\n                } else {\r\n                    this.cnv.crop.y2 = this.cnv.crop.y + this.cnv.crop.h;\r\n                }\r\n                this.cnv.crop.x2 = this.cnv.crop.x + 1;\r\n            }\r\n        } else {\r\n            this.adjustE(notDefaultSide, this.cnv.image.w);\r\n        }\r\n    } else {\r\n        if (this.cnv.cursor.x < this.cnv.image.w) {\r\n            if (this.cnv.cursor.x > this.cnv.crop.x) {\r\n                this.setWidth(this.cnv.cursor.x - this.cnv.crop.x);\r\n                this.cnv.crop.x2 = this.cnv.cursor.x;\r\n            } else {\r\n                this.setWidth(1);\r\n                this.cnv.crop.x2 = this.cnv.crop.x + 1;\r\n            }\r\n        } else {\r\n            this.setWidth(this.cnv.image.w - this.cnv.crop.x);\r\n            this.cnv.crop.x2 = this.cnv.image.w;\r\n        }\r\n    }\r\n};\r\n\r\n/**\r\n * Sets top-right corner.\r\n */\r\nCrop.prototype.setNE = function () {\r\n    if (this.options.ratio) {\r\n        if (Math.abs(this.cnv.cursor.x - this.cnv.crop.x2) > Math.abs(this.cnv.cursor.y - this.cnv.crop.y) && this.cnv.cursor.x <= this.cnv.crop.x2) {\r\n            this.setN();\r\n        } else {\r\n            (this.cnv.cursor.y >= this.cnv.crop.y) ? this.setE(true) : this.setN();\r\n        }\r\n    } else {\r\n        this.setN();\r\n        this.setE();\r\n    }\r\n};\r\n\r\n/**\r\n * Sets bottom-right corner.\r\n */\r\nCrop.prototype.setSE = function () {\r\n    if (this.options.ratio) {\r\n        if (Math.abs(this.cnv.cursor.x - this.cnv.crop.x2) > Math.abs(this.cnv.cursor.y - this.cnv.crop.y - this.cnv.crop.h) && this.cnv.cursor.x <= this.cnv.crop.x2) {\r\n            this.setS();\r\n        } else {\r\n            (this.cnv.cursor.y <= this.cnv.crop.y + this.cnv.crop.h) ? this.setE() : this.setS();\r\n        }\r\n    } else {\r\n        this.setS();\r\n        this.setE();\r\n    }\r\n};\r\n\r\n/**\r\n * Sets bottom-left corner.\r\n */\r\nCrop.prototype.setSW = function () {\r\n    if (this.options.ratio) {\r\n        if (Math.abs(this.cnv.cursor.x - this.cnv.crop.x) > Math.abs(this.cnv.cursor.y - this.cnv.crop.y - this.cnv.crop.h) && this.cnv.cursor.x >= this.cnv.crop.x) {\r\n            this.setS(true);\r\n        } else {\r\n            (this.cnv.cursor.y <= this.cnv.crop.y + this.cnv.crop.h) ? this.setW() : this.setS(true);\r\n        }\r\n    } else {\r\n        this.setS();\r\n        this.setW();\r\n    }\r\n};\r\n\r\n/**\r\n * Sets top-left corner.\r\n */\r\nCrop.prototype.setNW = function () {\r\n    if (this.options.ratio) {\r\n        if (Math.abs(this.cnv.cursor.x - this.cnv.crop.x) > Math.abs(this.cnv.cursor.y - this.cnv.crop.y) && this.cnv.cursor.x >= this.cnv.crop.x) {\r\n            this.setN(true);\r\n        } else {\r\n            (this.cnv.cursor.y >= this.cnv.crop.y) ? this.setW(true) : this.setN(true);\r\n        }\r\n    } else {\r\n        this.setN();\r\n        this.setW();\r\n    }\r\n};\r\n\r\n/**\r\n * Processes move crop selection.\r\n */\r\nCrop.prototype.move = function () {\r\n    var left = this.cnv.cursor.x - this.cnv.cursor.offsetX;\r\n    var top = this.cnv.cursor.y - this.cnv.cursor.offsetY;\r\n    if (left > 0) {\r\n        if (left + this.cnv.crop.w < this.cnv.image.w) {\r\n            this.setLeft(left);\r\n        } else {\r\n            this.setLeft(this.cnv.image.w - this.cnv.crop.w);\r\n        }\r\n    } else {\r\n        this.setLeft(0);\r\n    }\r\n\r\n    if (top > 0) {\r\n        if (top + this.cnv.crop.h < this.cnv.image.h) {\r\n            this.setTop(top);\r\n        } else {\r\n            this.setTop(this.cnv.image.h - this.cnv.crop.h);\r\n        }\r\n    } else {\r\n        this.setTop(0);\r\n    }\r\n\r\n    this.cnv.crop.x2 = this.cnv.crop.x + this.cnv.crop.w;\r\n    this.cnv.crop.y2 = this.cnv.crop.y + this.cnv.crop.h;\r\n};\r\n\r\n/**\r\n * Converts dataURI to Blob.\r\n * http://stackoverflow.com/questions/4998908/convert-data-uri-to-file-then-append-to-formdata\r\n * @param dataURI\r\n * @returns {Blob}\r\n */\r\nCrop.prototype.dataURItoBlob = function (dataURI) {\r\n\r\n    var content = [],\r\n        byteString,\r\n        mimeString;\r\n\r\n    if (dataURI.split(',')[0].indexOf('base64') !== -1) {\r\n        byteString = atob(dataURI.split(',')[1])\r\n    } else {\r\n        byteString = decodeURI(dataURI.split(',')[1])\r\n    }\r\n\r\n    mimeString = dataURI.split(',')[0].split(':')[1].split(';')[0];\r\n\r\n    for (var i = 0; i < byteString.length; i++) {\r\n        content[i] = byteString.charCodeAt(i)\r\n    }\r\n\r\n    return new Blob([new Uint8Array(content)], {type: mimeString});\r\n};\r\n\r\n/**\r\n * Saves results to preview.\r\n */\r\nCrop.prototype.save = function () {\r\n    'use strict';\r\n    var that = this;\r\n    var c = document.createElement(\"canvas\"),\r\n        ctx = c.getContext(\"2d\"),\r\n        img;\r\n    this.cnv.toSave = {//CoordinateS\r\n        w: Math.round(this.cnv.crop.w * this.cnv.scale),\r\n        h: Math.round(this.cnv.crop.h * this.cnv.scale),\r\n        x: Math.round(this.cnv.crop.x * this.cnv.scale),\r\n        y: Math.round(this.cnv.crop.y * this.cnv.scale)\r\n    };\r\n\r\n    c.width = this.cnv.toSave.w;\r\n    c.height = this.cnv.toSave.h;\r\n\r\n    function drawImageOnCanvas() {//TODO refactor this piece. Almost the same as in prepare().\r\n        try {\r\n            ctx.drawImage(that.img, that.cnv.toSave.x, that.cnv.toSave.y, that.cnv.toSave.w, that.cnv.toSave.h, 0, 0, that.cnv.toSave.w, that.cnv.toSave.h);\r\n        } catch (e) {\r\n            if (e.name == \"NS_ERROR_NOT_AVAILABLE\") {\r\n                setTimeout(drawImageOnCanvas, 0);\r\n            } else {\r\n                throw e;\r\n            }\r\n        }\r\n    }\r\n\r\n    drawImageOnCanvas();\r\n    this.strDataURI = c.toDataURL(\"image/jpeg\", 0.95);\r\n\r\n    img = new Image();\r\n    img.src = this.strDataURI;\r\n\r\n    this.setPreviewImage(img);\r\n    this.file.blob = this.dataURItoBlob(this.strDataURI);\r\n};\r\n\r\n/**\r\n * Attaches data to formData\r\n */\r\nCrop.prototype.attachData = function () {\r\n    var that = this;\r\n    if (this.form) {\r\n        if (this.options.format == \"cropped\") {\r\n            this.form.events.on(\"beforeSend\", function(options){\r\n                options.data.append(that.options.name, that.file.blob, that.file.name);\r\n            });\r\n        } else {\r\n            this.form.events.on(\"beforeSend\", function (options) {\r\n                options.data.append(that.options.name, that.file.file, that.file.name);\r\n                options.data.append(that.options.name + \"-cropData[cropWidth]\", that.cnv.toSave.w);\r\n                options.data.append(that.options.name + \"-cropData[cropHeight]\", that.cnv.toSave.h);\r\n                options.data.append(that.options.name + \"-cropData[cropX]\", that.cnv.toSave.x);\r\n                options.data.append(that.options.name + \"-cropData[cropY]\", that.cnv.toSave.y);\r\n            });\r\n        }\r\n    }\r\n};\r\n\r\nCrop.prototype.die = function () {\r\n    this.removeEventListeners();\r\n    this.removeModalEventListeners();\r\n    delete this;\r\n};\r\n\r\nexport { Crop as default };\n\n\n/** WEBPACK FOOTER **\n ** d:/OpenServer/domains/spiral-modules/cropper/src/crop.js\n **/","module.exports = { \"default\": require(\"core-js/library/fn/object/create\"), __esModule: true };\n\n\n/** WEBPACK FOOTER **\n ** d:/OpenServer/domains/spiral-modules/cropper/~/babel-runtime/core-js/object/create.js\n **/","var $ = require('../../modules/$');\nmodule.exports = function create(P, D){\n  return $.create(P, D);\n};\n\n\n/** WEBPACK FOOTER **\n ** d:/OpenServer/domains/spiral-modules/cropper/~/core-js/library/fn/object/create.js\n **/","var $Object = Object;\nmodule.exports = {\n  create:     $Object.create,\n  getProto:   $Object.getPrototypeOf,\n  isEnum:     {}.propertyIsEnumerable,\n  getDesc:    $Object.getOwnPropertyDescriptor,\n  setDesc:    $Object.defineProperty,\n  setDescs:   $Object.defineProperties,\n  getKeys:    $Object.keys,\n  getNames:   $Object.getOwnPropertyNames,\n  getSymbols: $Object.getOwnPropertySymbols,\n  each:       [].forEach\n};\n\n\n/** WEBPACK FOOTER **\n ** d:/OpenServer/domains/spiral-modules/cropper/~/core-js/library/modules/$.js\n **/","module.exports = \"<div class=sf-crop-modal><div class=sf-crop-modal-header><button class=sf-crop-close>×</button><div class=sf-crop-cropper-info><div class=sf-crop-ratio></div><div class=sf-crop-orig-size></div><div class=sf-crop-cropped-size></div></div></div><div class=sf-crop-modal-body><div class=sf-crop-container><div class=sf-crop-image-original></div><div class=sf-crop-wrapper><div class=sf-crop-dimmers-container><div class=dimmers><div class=\\\"dimmer dimmer-N\\\"></div><div class=\\\"dimmer dimmer-E\\\"></div><div class=\\\"dimmer dimmer-S\\\"></div><div class=\\\"dimmer dimmer-W\\\"></div></div></div><div class=sf-crop-elements><div class=\\\"handler handler-N\\\"></div><div class=\\\"handler handler-NE\\\"></div><div class=\\\"handler handler-E\\\"></div><div class=\\\"handler handler-SE\\\"></div><div class=\\\"handler handler-S\\\"></div><div class=\\\"handler handler-SW\\\"></div><div class=\\\"handler handler-W\\\"></div><div class=\\\"handler handler-NW\\\"></div></div></div></div></div><div class=sf-crop-modal-footer><br><button type=button class=\\\"btn sf-crop-save\\\">Save changes</button></div></div>\";\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/html-loader!./src/template.html\n ** module id = 6\n ** module chunks = 0 1\n **/","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!./../node_modules/css-loader/index.js?minimize!./../node_modules/less-loader/index.js!./crop.less\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// add the styles to the DOM\nvar update = require(\"!./../node_modules/style-loader/addStyles.js\")(content, {});\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!./../node_modules/css-loader/index.js?minimize!./../node_modules/less-loader/index.js!./crop.less\", function() {\n\t\t\tvar newContent = require(\"!!./../node_modules/css-loader/index.js?minimize!./../node_modules/less-loader/index.js!./crop.less\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/style-loader!./~/css-loader?minimize!./~/less-loader!./src/crop.less\n ** module id = 7\n ** module chunks = 0 1\n **/","exports = module.exports = require(\"./../node_modules/css-loader/lib/css-base.js\")();\n// imports\n\n\n// module\nexports.push([module.id, \".sf-crop-modal{position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);padding:20px;background-color:#fff;box-shadow:0 0 3px #000;overflow:auto;z-index:1000;width:auto;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.sf-crop-modal .sf-crop-save{display:block;margin:0 auto;border-width:0;border-radius:2px;box-shadow:0 1px 2px rgba(0,0,0,.6);background-color:#468ebe;color:#ecf0f1;transition:background-color .3s}.sf-crop-modal .sf-crop-save:focus,.sf-crop-modal .sf-crop-save:hover{background-color:#2778ae}.sf-crop-modal .sf-crop-container{position:relative}.sf-crop-modal .sf-crop-container canvas{display:block}.sf-crop-modal .sf-crop-wrapper{position:absolute;top:0;bottom:0;left:0;right:0}.sf-crop-modal .sf-crop-wrapper .sf-crop-elements{position:absolute;border:1px dashed #000;top:0;width:100%;height:100%;max-width:100%;max-height:100%;cursor:move}.sf-crop-modal .sf-crop-wrapper .sf-crop-dimmers-container{position:absolute;overflow:hidden;top:0;bottom:0;left:0;right:0}.sf-crop-modal .sf-crop-wrapper .dimmers{position:absolute}.sf-crop-modal .sf-crop-wrapper .dimmer{position:absolute;width:1000px;height:1000px;background-color:#000;opacity:.3}.sf-crop-modal .sf-crop-wrapper .dimmer.dimmer-N{bottom:100%;left:0}.sf-crop-modal .sf-crop-wrapper .dimmer.dimmer-E{left:100%;top:0}.sf-crop-modal .sf-crop-wrapper .dimmer.dimmer-S{top:100%;right:0}.sf-crop-modal .sf-crop-wrapper .dimmer.dimmer-W{bottom:0;right:100%}.sf-crop-modal .sf-crop-wrapper .handler{position:absolute;border:1px solid #333;width:10px;height:10px;background:#fff;opacity:.5}.sf-crop-modal .sf-crop-wrapper .handler.handler-N{top:0;left:50%;margin-top:-6px;margin-left:-6px;cursor:n-resize}.sf-crop-modal .sf-crop-wrapper .handler.handler-NE{top:0;right:0;margin-top:-6px;margin-right:-6px;cursor:ne-resize}.sf-crop-modal .sf-crop-wrapper .handler.handler-E{top:50%;right:0;margin-top:-6px;margin-right:-6px;cursor:e-resize}.sf-crop-modal .sf-crop-wrapper .handler.handler-SE{bottom:0;right:0;margin-bottom:-6px;margin-right:-6px;cursor:se-resize}.sf-crop-modal .sf-crop-wrapper .handler.handler-S{bottom:0;left:50%;margin-bottom:-6px;margin-left:-6px;cursor:s-resize}.sf-crop-modal .sf-crop-wrapper .handler.handler-SW{bottom:0;left:0;margin-bottom:-6px;margin-left:-6px;cursor:sw-resize}.sf-crop-modal .sf-crop-wrapper .handler.handler-W{top:50%;left:0;margin-top:-6px;margin-left:-6px;cursor:w-resize}.sf-crop-modal .sf-crop-wrapper .handler.handler-NW{top:0;left:0;margin-top:-6px;margin-left:-6px;cursor:nw-resize}.sf-crop-modal .sf-crop-modal-header{margin-bottom:20px}.sf-crop-modal .sf-crop-modal-header .sf-crop-cropper-info{font-size:12px}.sf-crop-modal .sf-crop-modal-header .sf-crop-close{position:absolute;background:transparent;padding:0;top:10px;right:15px;font-size:24px;border:none;opacity:.2;cursor:pointer}.sf-crop-modal .sf-crop-modal-header .sf-crop-close:hover{opacity:1}\", \"\"]);\n\n// exports\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/css-loader?minimize!./~/less-loader!./src/crop.less\n ** module id = 8\n ** module chunks = 0 1\n **/","/*\r\n\tMIT License http://www.opensource.org/licenses/mit-license.php\r\n\tAuthor Tobias Koppers @sokra\r\n*/\r\n// css base code, injected by the css-loader\r\nmodule.exports = function() {\r\n\tvar list = [];\r\n\r\n\t// return the list of modules as css string\r\n\tlist.toString = function toString() {\r\n\t\tvar result = [];\r\n\t\tfor(var i = 0; i < this.length; i++) {\r\n\t\t\tvar item = this[i];\r\n\t\t\tif(item[2]) {\r\n\t\t\t\tresult.push(\"@media \" + item[2] + \"{\" + item[1] + \"}\");\r\n\t\t\t} else {\r\n\t\t\t\tresult.push(item[1]);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result.join(\"\");\r\n\t};\r\n\r\n\t// import a list of modules into the list\r\n\tlist.i = function(modules, mediaQuery) {\r\n\t\tif(typeof modules === \"string\")\r\n\t\t\tmodules = [[null, modules, \"\"]];\r\n\t\tvar alreadyImportedModules = {};\r\n\t\tfor(var i = 0; i < this.length; i++) {\r\n\t\t\tvar id = this[i][0];\r\n\t\t\tif(typeof id === \"number\")\r\n\t\t\t\talreadyImportedModules[id] = true;\r\n\t\t}\r\n\t\tfor(i = 0; i < modules.length; i++) {\r\n\t\t\tvar item = modules[i];\r\n\t\t\t// skip already imported module\r\n\t\t\t// this implementation is not 100% perfect for weird media query combinations\r\n\t\t\t//  when a module is imported multiple times with different media queries.\r\n\t\t\t//  I hope this will never occur (Hey this way we have smaller bundles)\r\n\t\t\tif(typeof item[0] !== \"number\" || !alreadyImportedModules[item[0]]) {\r\n\t\t\t\tif(mediaQuery && !item[2]) {\r\n\t\t\t\t\titem[2] = mediaQuery;\r\n\t\t\t\t} else if(mediaQuery) {\r\n\t\t\t\t\titem[2] = \"(\" + item[2] + \") and (\" + mediaQuery + \")\";\r\n\t\t\t\t}\r\n\t\t\t\tlist.push(item);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\treturn list;\r\n};\r\n\n\n\n/** WEBPACK FOOTER **\n ** d:/OpenServer/domains/spiral-modules/cropper/~/css-loader/lib/css-base.js\n **/","/*\r\n\tMIT License http://www.opensource.org/licenses/mit-license.php\r\n\tAuthor Tobias Koppers @sokra\r\n*/\r\nvar stylesInDom = {},\r\n\tmemoize = function(fn) {\r\n\t\tvar memo;\r\n\t\treturn function () {\r\n\t\t\tif (typeof memo === \"undefined\") memo = fn.apply(this, arguments);\r\n\t\t\treturn memo;\r\n\t\t};\r\n\t},\r\n\tisOldIE = memoize(function() {\r\n\t\treturn /msie [6-9]\\b/.test(window.navigator.userAgent.toLowerCase());\r\n\t}),\r\n\tgetHeadElement = memoize(function () {\r\n\t\treturn document.head || document.getElementsByTagName(\"head\")[0];\r\n\t}),\r\n\tsingletonElement = null,\r\n\tsingletonCounter = 0,\r\n\tstyleElementsInsertedAtTop = [];\r\n\r\nmodule.exports = function(list, options) {\r\n\tif(typeof DEBUG !== \"undefined\" && DEBUG) {\r\n\t\tif(typeof document !== \"object\") throw new Error(\"The style-loader cannot be used in a non-browser environment\");\r\n\t}\r\n\r\n\toptions = options || {};\r\n\t// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\r\n\t// tags it will allow on a page\r\n\tif (typeof options.singleton === \"undefined\") options.singleton = isOldIE();\r\n\r\n\t// By default, add <style> tags to the bottom of <head>.\r\n\tif (typeof options.insertAt === \"undefined\") options.insertAt = \"bottom\";\r\n\r\n\tvar styles = listToStyles(list);\r\n\taddStylesToDom(styles, options);\r\n\r\n\treturn function update(newList) {\r\n\t\tvar mayRemove = [];\r\n\t\tfor(var i = 0; i < styles.length; i++) {\r\n\t\t\tvar item = styles[i];\r\n\t\t\tvar domStyle = stylesInDom[item.id];\r\n\t\t\tdomStyle.refs--;\r\n\t\t\tmayRemove.push(domStyle);\r\n\t\t}\r\n\t\tif(newList) {\r\n\t\t\tvar newStyles = listToStyles(newList);\r\n\t\t\taddStylesToDom(newStyles, options);\r\n\t\t}\r\n\t\tfor(var i = 0; i < mayRemove.length; i++) {\r\n\t\t\tvar domStyle = mayRemove[i];\r\n\t\t\tif(domStyle.refs === 0) {\r\n\t\t\t\tfor(var j = 0; j < domStyle.parts.length; j++)\r\n\t\t\t\t\tdomStyle.parts[j]();\r\n\t\t\t\tdelete stylesInDom[domStyle.id];\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n}\r\n\r\nfunction addStylesToDom(styles, options) {\r\n\tfor(var i = 0; i < styles.length; i++) {\r\n\t\tvar item = styles[i];\r\n\t\tvar domStyle = stylesInDom[item.id];\r\n\t\tif(domStyle) {\r\n\t\t\tdomStyle.refs++;\r\n\t\t\tfor(var j = 0; j < domStyle.parts.length; j++) {\r\n\t\t\t\tdomStyle.parts[j](item.parts[j]);\r\n\t\t\t}\r\n\t\t\tfor(; j < item.parts.length; j++) {\r\n\t\t\t\tdomStyle.parts.push(addStyle(item.parts[j], options));\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tvar parts = [];\r\n\t\t\tfor(var j = 0; j < item.parts.length; j++) {\r\n\t\t\t\tparts.push(addStyle(item.parts[j], options));\r\n\t\t\t}\r\n\t\t\tstylesInDom[item.id] = {id: item.id, refs: 1, parts: parts};\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction listToStyles(list) {\r\n\tvar styles = [];\r\n\tvar newStyles = {};\r\n\tfor(var i = 0; i < list.length; i++) {\r\n\t\tvar item = list[i];\r\n\t\tvar id = item[0];\r\n\t\tvar css = item[1];\r\n\t\tvar media = item[2];\r\n\t\tvar sourceMap = item[3];\r\n\t\tvar part = {css: css, media: media, sourceMap: sourceMap};\r\n\t\tif(!newStyles[id])\r\n\t\t\tstyles.push(newStyles[id] = {id: id, parts: [part]});\r\n\t\telse\r\n\t\t\tnewStyles[id].parts.push(part);\r\n\t}\r\n\treturn styles;\r\n}\r\n\r\nfunction insertStyleElement(options, styleElement) {\r\n\tvar head = getHeadElement();\r\n\tvar lastStyleElementInsertedAtTop = styleElementsInsertedAtTop[styleElementsInsertedAtTop.length - 1];\r\n\tif (options.insertAt === \"top\") {\r\n\t\tif(!lastStyleElementInsertedAtTop) {\r\n\t\t\thead.insertBefore(styleElement, head.firstChild);\r\n\t\t} else if(lastStyleElementInsertedAtTop.nextSibling) {\r\n\t\t\thead.insertBefore(styleElement, lastStyleElementInsertedAtTop.nextSibling);\r\n\t\t} else {\r\n\t\t\thead.appendChild(styleElement);\r\n\t\t}\r\n\t\tstyleElementsInsertedAtTop.push(styleElement);\r\n\t} else if (options.insertAt === \"bottom\") {\r\n\t\thead.appendChild(styleElement);\r\n\t} else {\r\n\t\tthrow new Error(\"Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.\");\r\n\t}\r\n}\r\n\r\nfunction removeStyleElement(styleElement) {\r\n\tstyleElement.parentNode.removeChild(styleElement);\r\n\tvar idx = styleElementsInsertedAtTop.indexOf(styleElement);\r\n\tif(idx >= 0) {\r\n\t\tstyleElementsInsertedAtTop.splice(idx, 1);\r\n\t}\r\n}\r\n\r\nfunction createStyleElement(options) {\r\n\tvar styleElement = document.createElement(\"style\");\r\n\tstyleElement.type = \"text/css\";\r\n\tinsertStyleElement(options, styleElement);\r\n\treturn styleElement;\r\n}\r\n\r\nfunction createLinkElement(options) {\r\n\tvar linkElement = document.createElement(\"link\");\r\n\tlinkElement.rel = \"stylesheet\";\r\n\tinsertStyleElement(options, linkElement);\r\n\treturn linkElement;\r\n}\r\n\r\nfunction addStyle(obj, options) {\r\n\tvar styleElement, update, remove;\r\n\r\n\tif (options.singleton) {\r\n\t\tvar styleIndex = singletonCounter++;\r\n\t\tstyleElement = singletonElement || (singletonElement = createStyleElement(options));\r\n\t\tupdate = applyToSingletonTag.bind(null, styleElement, styleIndex, false);\r\n\t\tremove = applyToSingletonTag.bind(null, styleElement, styleIndex, true);\r\n\t} else if(obj.sourceMap &&\r\n\t\ttypeof URL === \"function\" &&\r\n\t\ttypeof URL.createObjectURL === \"function\" &&\r\n\t\ttypeof URL.revokeObjectURL === \"function\" &&\r\n\t\ttypeof Blob === \"function\" &&\r\n\t\ttypeof btoa === \"function\") {\r\n\t\tstyleElement = createLinkElement(options);\r\n\t\tupdate = updateLink.bind(null, styleElement);\r\n\t\tremove = function() {\r\n\t\t\tremoveStyleElement(styleElement);\r\n\t\t\tif(styleElement.href)\r\n\t\t\t\tURL.revokeObjectURL(styleElement.href);\r\n\t\t};\r\n\t} else {\r\n\t\tstyleElement = createStyleElement(options);\r\n\t\tupdate = applyToTag.bind(null, styleElement);\r\n\t\tremove = function() {\r\n\t\t\tremoveStyleElement(styleElement);\r\n\t\t};\r\n\t}\r\n\r\n\tupdate(obj);\r\n\r\n\treturn function updateStyle(newObj) {\r\n\t\tif(newObj) {\r\n\t\t\tif(newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap)\r\n\t\t\t\treturn;\r\n\t\t\tupdate(obj = newObj);\r\n\t\t} else {\r\n\t\t\tremove();\r\n\t\t}\r\n\t};\r\n}\r\n\r\nvar replaceText = (function () {\r\n\tvar textStore = [];\r\n\r\n\treturn function (index, replacement) {\r\n\t\ttextStore[index] = replacement;\r\n\t\treturn textStore.filter(Boolean).join('\\n');\r\n\t};\r\n})();\r\n\r\nfunction applyToSingletonTag(styleElement, index, remove, obj) {\r\n\tvar css = remove ? \"\" : obj.css;\r\n\r\n\tif (styleElement.styleSheet) {\r\n\t\tstyleElement.styleSheet.cssText = replaceText(index, css);\r\n\t} else {\r\n\t\tvar cssNode = document.createTextNode(css);\r\n\t\tvar childNodes = styleElement.childNodes;\r\n\t\tif (childNodes[index]) styleElement.removeChild(childNodes[index]);\r\n\t\tif (childNodes.length) {\r\n\t\t\tstyleElement.insertBefore(cssNode, childNodes[index]);\r\n\t\t} else {\r\n\t\t\tstyleElement.appendChild(cssNode);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction applyToTag(styleElement, obj) {\r\n\tvar css = obj.css;\r\n\tvar media = obj.media;\r\n\tvar sourceMap = obj.sourceMap;\r\n\r\n\tif(media) {\r\n\t\tstyleElement.setAttribute(\"media\", media)\r\n\t}\r\n\r\n\tif(styleElement.styleSheet) {\r\n\t\tstyleElement.styleSheet.cssText = css;\r\n\t} else {\r\n\t\twhile(styleElement.firstChild) {\r\n\t\t\tstyleElement.removeChild(styleElement.firstChild);\r\n\t\t}\r\n\t\tstyleElement.appendChild(document.createTextNode(css));\r\n\t}\r\n}\r\n\r\nfunction updateLink(linkElement, obj) {\r\n\tvar css = obj.css;\r\n\tvar media = obj.media;\r\n\tvar sourceMap = obj.sourceMap;\r\n\r\n\tif(sourceMap) {\r\n\t\t// http://stackoverflow.com/a/26603875\r\n\t\tcss += \"\\n/*# sourceMappingURL=data:application/json;base64,\" + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + \" */\";\r\n\t}\r\n\r\n\tvar blob = new Blob([css], { type: \"text/css\" });\r\n\r\n\tvar oldSrc = linkElement.href;\r\n\r\n\tlinkElement.href = URL.createObjectURL(blob);\r\n\r\n\tif(oldSrc)\r\n\t\tURL.revokeObjectURL(oldSrc);\r\n}\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/style-loader/addStyles.js\n ** module id = 10\n ** module chunks = 0 1\n **/"],"sourceRoot":""}